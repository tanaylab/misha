% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/synth.R
\name{gsynth.sample}
\alias{gsynth.sample}
\title{Sample a synthetic genome from a trained Markov model}
\usage{
gsynth.sample(
  model,
  output_path = NULL,
  output_format = c("misha", "fasta", "vector"),
  mask_copy = NULL,
  seed = NULL,
  intervals = NULL,
  n_samples = 1,
  bin_merge = NULL
)
}
\arguments{
\item{model}{A gsynth.model object from \code{\link{gsynth.train}}}

\item{output_path}{Path to the output file (ignored when output_format = "vector")}

\item{output_format}{Output format:
\itemize{
  \item "misha": .seq binary format (default)
  \item "fasta": FASTA text format
  \item "vector": Return sequences as a character vector (does not write to file)
}}

\item{mask_copy}{Optional intervals to copy from the original genome instead of
sampling. Use this to preserve specific regions (e.g., repeats, regulatory
elements) exactly as they appear in the reference. Regions not in mask_copy
will be sampled using the Markov model.}

\item{seed}{Random seed for reproducibility. If NULL, uses current random state.}

\item{intervals}{Genomic intervals to sample. If NULL, uses all chromosomes.}

\item{n_samples}{Number of samples to generate per interval. Default is 1.
When n_samples > 1 and output_format = "fasta", headers include "_sampleN".
When output_format = "vector", returns n_samples * n_intervals sequences.}

\item{bin_merge}{Optional list of bin merge specifications to apply during sampling,
one per dimension. Each element should be a list of merge specifications
(same format as in \code{\link{gsynth.train}}), or NULL to use the
bin mapping from training. This allows merging sparse bins at sampling time
without re-training the model.}
}
\value{
When output_format is "misha" or "fasta", returns invisible NULL and
        writes the synthetic genome to output_path. When output_format is "vector",
        returns a character vector of sequences (length = n_intervals * n_samples).
}
\description{
Generates a synthetic genome by sampling from a trained stratified Markov-5
model. The generated genome preserves the k-mer statistics of the original
genome within each stratification bin.
}
\examples{
gdb.init_examples()

# Create virtual tracks
gvtrack.create("g_frac", NULL, "kmer.frac", kmer = "G")
gvtrack.create("c_frac", NULL, "kmer.frac", kmer = "C")
gvtrack.create("cg_frac", NULL, "kmer.frac", kmer = "CG")
gvtrack.create("masked_frac", NULL, "masked.frac")

# Define repeat mask (regions to preserve from original)
repeats <- gscreen("masked_frac > 0.5",
    intervals = gintervals.all(),
    iterator = 100
)

# Train model (excluding repeats from training)
model <- gsynth.train(
    list(expr = "g_frac + c_frac", breaks = seq(0, 1, 0.025)),
    list(expr = "cg_frac", breaks = c(0, 0.01, 0.02, 0.03, 0.04, 0.2)),
    mask = repeats,
    iterator = 200,
    min_obs = 1000
)

# Sample with mask_copy to preserve repeats from original genome
gsynth.sample(model, "synthetic_genome.fa",
    output_format = "fasta",
    mask_copy = repeats,
    seed = 60427,
    bin_merge = list(
        list(list(from = 0.7, to = c(0.675, 0.7))),
        list(list(from = 0.04, to = c(0.03, 0.04)))
    )
)

}
\seealso{
\code{\link{gsynth.train}}, \code{\link{gsynth.save}}
}
