% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/canvas.R
\name{gcanvas.sample}
\alias{gcanvas.sample}
\title{Sample a synthetic genome from a trained Markov model}
\usage{
gcanvas.sample(
  model,
  output_path,
  output_format = c("misha", "fasta"),
  mask = NULL,
  mask_mode = c("sample", "copy"),
  seed = NULL,
  intervals = NULL
)
}
\arguments{
\item{model}{A gcanvas.model object from \code{\link{gcanvas.train}}}

\item{output_path}{Path to the output file}

\item{output_format}{Output format: "misha" for .seq binary format,
"fasta" for FASTA text format}

\item{mask}{Optional intervals for special handling during sampling}

\item{mask_mode}{How to handle masked regions:
\itemize{
  \item "sample": Sample masked regions like any other (ignore mask)
  \item "copy": Copy masked regions from the original genome
}}

\item{seed}{Random seed for reproducibility. If NULL, uses current random state.}

\item{intervals}{Genomic intervals to sample. If NULL, uses all chromosomes.}
}
\value{
Invisible NULL. The synthetic genome is written to output_path.
}
\description{
Generates a synthetic genome by sampling from a trained stratified Markov-5
model. The generated genome preserves the k-mer statistics of the original
genome within each stratification bin.
}
\examples{
gdb.init_examples()

# Train a model first
gvtrack.create("g_frac", NULL, "kmer.frac", kmer = "G")
gvtrack.create("c_frac", NULL, "kmer.frac", kmer = "C")
gvtrack.create("masked_frac", NULL, "masked.frac")

# Define repeat mask
repeats <- gscreen("masked_frac > 0.5",
    intervals = gintervals.all(),
    iterator = 100
)
model <- gcanvas.train(
    expr = "g_frac + c_frac",
    breaks = seq(0, 1, 0.025),
    mask = repeats,
    iterator = 200
)

# Sample a synthetic genome
gcanvas.sample(model, "synthetic_genome.fa",
    output_format = "fasta",
    mask = repeats,
    mask_mode = "copy",
    seed = 60427
)

}
\seealso{
\code{\link{gcanvas.train}}, \code{\link{gcanvas.save}}
}
