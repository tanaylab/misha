% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/track-export.R
\name{gtrack.export_bed}
\alias{gtrack.export_bed}
\title{Export Track to BED Format}
\usage{
gtrack.export_bed(
  track,
  file,
  intervals = get("ALLGENOME", envir = .misha),
  iterator = NULL,
  na_value = NULL,
  track_name = NULL,
  description = NULL
)
}
\arguments{
\item{track}{Track name or track expression to export. Can be a regular track name,
a virtual track (e.g., "gc", "kmer.count"), or a track expression (e.g., "track1 + track2").}

\item{file}{Output BED file path. Should end in .bed.}

\item{intervals}{Genomic intervals to export. Default is ALLGENOME (entire genome).}

\item{iterator}{Iterator for computing track values. Can be:
\itemize{
  \item Numeric: bin size in base pairs (e.g., \code{iterator = 1000} for 1kb bins)
  \item Character: track name to use as iterator intervals
  \item data.frame: explicit intervals to use as iterator
  \item NULL (default): use track's native resolution
}}

\item{na_value}{How to handle NaN/NA values in the score column:
\itemize{
  \item NULL (default): Write "." for NaN/NA values (standard BED convention)
  \item numeric: Replace NaN/NA values with this value (e.g., \code{na_value = 0})
}}

\item{track_name}{Optional track name for BED header line. If provided, a track definition
line will be added at the start of the file.}

\item{description}{Optional description for BED header line. Only used if \code{track_name}
is also provided.}
}
\value{
Invisibly returns the file path (useful for piping).
}
\description{
Exports a misha track to BED format. Works with dense tracks, sparse tracks,
virtual tracks, and track expressions. Output format (BED3/BED5/BED6) is
automatically detected based on available data.
}
\details{
The output format is automatically determined based on the extracted data:
\itemize{
  \item BED3: Only chrom, start, end (no track values extracted)
  \item BED5: Track values present → chrom, start, end, name, score
  \item BED6: Track values and strand present → chrom, start, end, name, score, strand
}

For BED5/BED6 formats, the name field is auto-generated as "interval_N".

**Coordinate System:** Both misha and BED format use 0-based half-open intervals [start, end),
so coordinates are written directly without conversion. This is different from BigWig export
which requires start+1 conversion.

The function uses \code{\link{gextract}} internally, which provides a unified interface
for extracting data from all track types. The \code{iterator} parameter is particularly
useful for:
\itemize{
  \item Binning high-resolution tracks into fixed-size windows
  \item Computing track expressions in specific genomic regions
  \item Evaluating virtual tracks (which require an iterator)
}
}
\examples{
\dontrun{
# Export sparse track at native resolution
gtrack.export_bed("my.track", "output.bed")

# Export track binned at 1kb resolution
gtrack.export_bed("my.track", "output_1kb.bed", iterator = 1000)

# Export virtual track (GC content in 500bp windows)
gtrack.export_bed("gc", "gc_content.bed", iterator = 500)

# Export track expression
gtrack.export_bed("track1 + track2", "combined.bed", iterator = 1000)

# Export specific chromosomes with track header
gtrack.export_bed("my.track", "chr1.bed",
    intervals = gintervals(1),
    track_name = "MyTrack",
    description = "Chromosome 1 data"
)

# Replace NaN values with 0
gtrack.export_bed("coverage.track", "coverage.bed", na_value = 0, iterator = 100)
}

}
\seealso{
\code{\link{gtrack.export_bw}} for BigWig export,
  \code{\link{gtrack.import}} for importing tracks including BED files,
  \code{\link{gextract}} for extracting track data,
  \code{\link{gintervals.export_bed}} for exporting intervals without track values
}
