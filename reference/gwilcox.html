<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculates Wilcoxon test on sliding windows over track expression — gwilcox • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculates Wilcoxon test on sliding windows over track expression — gwilcox"><meta property="og:description" content="Calculates Wilcoxon test on sliding windows over the values of track
expression."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculates Wilcoxon test on sliding windows over track expression</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/HEAD/R/compute.R" class="external-link"><code>R/compute.R</code></a></small>
    <div class="hidden name"><code>gwilcox.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates Wilcoxon test on sliding windows over the values of track
expression.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gwilcox</span><span class="op">(</span></span>
<span>  expr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  winsize1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  winsize2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxpval <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  onetailed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  what2find <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  intervals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  iterator <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intervals.set.out <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>expr</dt>
<dd><p>track expression</p></dd>


<dt>winsize1</dt>
<dd><p>number of values in the first sliding window</p></dd>


<dt>winsize2</dt>
<dd><p>number of values in the second sliding window</p></dd>


<dt>maxpval</dt>
<dd><p>maximal P-value</p></dd>


<dt>onetailed</dt>
<dd><p>if 'TRUE', Wilcoxon test is performed one tailed, otherwise
two tailed</p></dd>


<dt>what2find</dt>
<dd><p>if '-1', lows are searched. If '1', peaks are searched. If
'0', both peaks and lows are searched</p></dd>


<dt>intervals</dt>
<dd><p>genomic scope for which the function is applied</p></dd>


<dt>iterator</dt>
<dd><p>track expression iterator of "fixed bin" type. If 'NULL'
iterator is determined implicitly based on track expression.</p></dd>


<dt>intervals.set.out</dt>
<dd><p>intervals set name where the function result is
optionally outputted</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If 'intervals.set.out' is 'NULL' a data frame representing the
intervals with an additional 'pval' column where P-value is below 'maxpval'.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function runs a Wilcoxon test (also known as a Mann-Whitney test) over
the values of track expression in the two sliding windows having an
identical center. The sizes of the windows are specified by 'winsize1' and
'winsize2'. 'gwilcox' returns intervals where the smaller window tested
against a larger window gives a P-value below 'maxpval'. The test can be one
or two tailed.</p>
<p>'what2find' argument controls what should be searched: peaks, lows or both.</p>
<p>If 'intervals.set.out' is not 'NULL' the result is saved as an intervals
set. Use this parameter if the result size exceeds the limits of the
physical memory.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gscreen.html">gscreen</a></code>, <code><a href="gsegment.html">gsegment</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \dontshow{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>gmax.processes <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gwilcox</span><span class="op">(</span><span class="st">"dense_track"</span>, <span class="fl">100000</span>, <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    maxpval <span class="op">=</span> <span class="fl">0.01</span>,</span></span>
<span class="r-in"><span>    what2find <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom  start    end         pval</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1      0    650 6.259068e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  31750  36650 3.230735e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  37600  39750 8.149484e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  60450  62100 5.452999e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  64600  68900 1.536396e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  69400  71000 5.134420e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  71050  77050 3.392364e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  89900  91700 5.214742e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  99150 101100 4.321116e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1 106650 110850 7.451052e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1 114550 117800 4.517828e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1 119600 120900 3.503083e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1 138050 140000 1.391299e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1 150450 153300 4.480170e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1 153400 155850 7.935469e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1 166000 167800 1.995862e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1 221450 223550 2.754194e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1 236200 237800 6.262228e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1 246100 247300 2.073013e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1 253050 257200 9.573318e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  chr1 323900 325350 1.789731e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  chr1 327000 333350 3.616736e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  chr1 335650 338600 8.590741e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  chr1 339250 341950 1.306270e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  chr1 345600 346850 1.544731e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  chr1 353150 354400 1.328745e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  chr1 355850 357400 8.570873e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  chr1 358800 359900 9.412577e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  chr1 370500 371800 8.343761e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  chr1 372800 374250 2.156471e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  chr1 378700 385200 5.836447e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  chr1 398750 402200 7.187603e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  chr1 404600 406150 4.861715e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  chr1 407750 408800 5.158613e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  chr1 409000 411300 1.238897e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  chr1 413150 414600 5.000712e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  chr1 420050 421100 9.127494e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  chr1 437500 438850 7.115249e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  chr1 443000 444200 7.526990e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  chr1 450200 451450 1.502912e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  chr1 452800 454150 5.634265e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  chr1 455850 457450 4.320016e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  chr1 459850 461750 6.644247e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  chr2   2650   3950 2.982702e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  chr2   4100   5250 5.145261e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  chr2  29300  31200 7.186895e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  chr2  31500  32950 5.595490e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  chr2  37650  40800 3.808473e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  chr2  42200  45150 5.061067e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  chr2  50450  52000 1.174162e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  chr2  56350  59550 8.522234e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  chr2  76450  77500 9.085247e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  chr2  78500  80900 1.193580e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  chr2  82850  84650 8.147982e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  chr2  84750  89700 6.851225e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  chr2  99600 101550 4.784221e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  chr2 113300 114350 9.711064e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  chr2 124050 125800 4.682674e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  chr2 133550 135300 1.988063e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  chr2 138850 140100 7.080966e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  chr2 153350 156000 4.035042e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  chr2 157300 160900 3.763693e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  chr2 161850 163800 5.561545e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  chr2 164450 165800 4.125066e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  chr2 171000 173650 7.423077e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  chr2 178200 180500 2.461700e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  chr2 195750 196800 8.421521e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68  chr2 197750 199700 3.419243e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  chr2 208000 209250 7.472793e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  chr2 214900 218500 5.921503e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  chr2 222750 224500 2.526845e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72  chr2 230200 234050 4.451623e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73  chr2 236150 238350 1.136839e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74  chr2 239800 241200 2.977583e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  chr2 249050 250400 6.186424e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  chr2 251000 252500 7.463579e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77  chr2 268750 269900 5.404431e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78  chr2 275400 277000 2.654262e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  chr2 281150 282450 1.399682e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  chr2 288350 290950 4.984661e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  chr2 293750 295350 5.226153e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  chrX      0    900 1.768339e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  chrX   1000   3100 3.085641e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  chrX   5050   6800 1.793621e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  chrX  10850  16550 7.498458e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  chrX  84350  86200 1.268948e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  chrX  89800  95100 4.628085e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  chrX 116400 118050 3.115843e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  chrX 119400 122300 5.102100e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  chrX 124400 128100 2.769534e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  chrX 134900 136850 2.763108e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  chrX 138450 139550 4.878393e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  chrX 142450 144300 1.585345e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  chrX 149800 152200 9.806932e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  chrX 159300 161000 1.390129e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  chrX 165600 167500 9.145936e-04</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

