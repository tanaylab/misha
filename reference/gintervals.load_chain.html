<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Loads assembly conversion table from a chain file — gintervals.load_chain • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Loads assembly conversion table from a chain file — gintervals.load_chain"><meta property="og:description" content="Loads assembly conversion table from a chain file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Database-Formats.html">Database Formats and Multi-Contig Support</a>
    </li>
    <li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Loads assembly conversion table from a chain file</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/intervals-liftover.R" class="external-link"><code>R/intervals-liftover.R</code></a></small>
    <div class="hidden name"><code>gintervals.load_chain.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Loads assembly conversion table from a chain file.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gintervals.load_chain</span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  src_overlap_policy <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>  tgt_overlap_policy <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  src_groot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_score <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>name of chain file</p></dd>


<dt id="arg-src-overlap-policy">src_overlap_policy<a class="anchor" aria-label="anchor" href="#arg-src-overlap-policy"></a></dt>
<dd><p>policy for handling source overlaps: "error" (default), "keep", or "discard". "keep" allows one source interval to map to multiple target intervals, "discard" discards all source intervals that have overlaps and "error" throws an error if source overlaps are detected.</p></dd>


<dt id="arg-tgt-overlap-policy">tgt_overlap_policy<a class="anchor" aria-label="anchor" href="#arg-tgt-overlap-policy"></a></dt>
<dd><p>policy for handling target overlaps. One of:</p><table class="table table"><tr><td>Policy</td><td>Description</td></tr><tr><td>error</td><td>Throws an error if any target overlaps are detected.</td></tr><tr><td>auto</td><td>Default. Alias for "auto_score".</td></tr><tr><td>auto_score</td><td>Resolves overlaps by segmenting the target region and selecting the best chain for each segment based on alignment score (highest score wins). Tie-breakers: longest span, then lowest chain_id.</td></tr><tr><td>auto_longer</td><td>Resolves overlaps by segmenting and selecting the chain with the longest span for each segment. Tie-breakers: highest score, then lowest chain_id.</td></tr><tr><td>auto_first</td><td>Resolves overlaps by segmenting and selecting the chain with the lowest chain_id for each segment.</td></tr><tr><td>keep</td><td>Preserves all overlapping intervals.</td></tr><tr><td>discard</td><td>Discards any chain interval that has a target overlap with another chain interval.</td></tr><tr><td>agg</td><td>Segments overlaps into smaller disjoint regions where each region contains all contributing chains, allowing downstream aggregation to process multiple values per region.</td></tr><tr><td>best_source_cluster</td><td>Best source cluster strategy based on source overlap. When multiple chains map a source interval, clusters them by source overlap: if chain source intervals overlap (indicating true duplications), all mappings are retained; if chain source intervals are disjoint (indicating conflicting/alternative mappings), only the cluster with the largest total target length is kept.</td></tr></table></dd>


<dt id="arg-src-groot">src_groot<a class="anchor" aria-label="anchor" href="#arg-src-groot"></a></dt>
<dd><p>optional path to source genome database for validating source chromosomes and coordinates. If provided, the function temporarily switches to this database to verify that all source chromosomes exist and coordinates are within bounds, then restores the original database.</p></dd>


<dt id="arg-min-score">min_score<a class="anchor" aria-label="anchor" href="#arg-min-score"></a></dt>
<dd><p>optional minimum alignment score threshold. Chains with scores below this value are filtered out. Useful for excluding low-quality alignments.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame representing assembly conversion table with columns: chrom, start, end, strand, chromsrc, startsrc, endsrc, strandsrc, chain_id, score.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function reads a file in 'chain' format and returns assembly conversion
table that can be used in 'gtrack.liftover' and 'gintervals.liftover'.</p>
<p>Source overlaps occur when the same source genome position maps to multiple
target genome positions. Target overlaps occur when multiple source positions
map to overlapping regions in the target genome.</p>
<p>The 'src_overlap_policy' controls how source overlaps are handled:</p><ul><li><p>"error" (default): Throw an error if source overlaps are detected</p></li>
<li><p>"keep": Keep all mappings, allowing one source to map to multiple targets</p></li>
<li><p>"discard": Remove all chain intervals involved in source overlaps</p></li>
</ul><p>The 'tgt_overlap_policy' controls how target overlaps are handled:</p><ul><li><p>"error": Throw an error if target overlaps are detected</p></li>
<li><p>"auto" (default) / "auto_first": Keep the first overlapping chain (original file order) by trimming or discarding later overlaps while keeping source/target lengths consistent</p></li>
<li><p>"auto_longer": Keep the longer overlapping chain and trim/drop the shorter ones</p></li>
<li><p>"discard": Remove all chain intervals involved in target overlaps</p></li>
<li><p>"keep": Allow target overlaps to remain untouched (liftover must be able to handle them)</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gintervals.liftover.html">gintervals.liftover</a></code>, <code><a href="gtrack.liftover.html">gtrack.liftover</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chainfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">.misha</span><span class="op">$</span><span class="va">GROOT</span>, <span class="st">"data/test.chain"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Load chain file with default policies</span></span></span>
<span class="r-in"><span><span class="fu">gintervals.load_chain</span><span class="op">(</span><span class="va">chainfile</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chrom start   end strand chromsrc startsrc endsrc strandsrc chain_id score</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  chr1 12000 12500      1    chr25     2000   2500         1        1 2e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  chr1 12700 13500      1    chr25     2500   3300         1        1 2e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  chr1 14100 18500      1    chr25     3600   8000         1        1 2e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  chrX  5000  7000      1    chr25    10000  12000         1        2 2e+05</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

