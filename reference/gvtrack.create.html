<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Creates a new virtual track — gvtrack.create • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a new virtual track — gvtrack.create"><meta property="og:description" content="Creates a new virtual track."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates a new virtual track</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/vtrack.R" class="external-link"><code>R/vtrack.R</code></a></small>
    <div class="hidden name"><code>gvtrack.create.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a new virtual track.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gvtrack.create</span><span class="op">(</span>vtrack <span class="op">=</span> <span class="cn">NULL</span>, src <span class="op">=</span> <span class="cn">NULL</span>, func <span class="op">=</span> <span class="cn">NULL</span>, params <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-vtrack">vtrack<a class="anchor" aria-label="anchor" href="#arg-vtrack"></a></dt>
<dd><p>virtual track name</p></dd>


<dt id="arg-src">src<a class="anchor" aria-label="anchor" href="#arg-src"></a></dt>
<dd><p>source (track/intervals). NULL for PWM functions</p></dd>


<dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>function name (see above)</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>function parameters (see above)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional PWM parameters</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>None.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function creates a new virtual track named 'vtrack' with the given
source, function and parameters. 'src' can be either a track or intervals
(1D or 2D). Use the following table for a reference of all valid source,
function and parameters combinations:</p>
<p><em>src = [Track], func = "avg", params = NULL</em> <br> Average track value in
iterator interval.</p>
<p><em>src = [Track], func = "max", params = NULL</em> <br> Maximal track value in
iterator interval.</p>
<p><em>src = [Track], func = "min", params = NULL</em> <br> Minimal track value in
iterator interval.</p>
<p><em>src = ['Dense' / 'Sparse' / 'Array' track], func = "nearest", params =
NULL</em> <br> Mean track value in iterator interval. If there are no track
values covered by an iterator interator (can occur only in 'Sparse' track),
the nearest track value is returned.</p>
<p><em>src = ['Dense' / 'Sparse' / 'Array' track], func = "stddev", params =
NULL</em> <br> Unbiased standard deviation of track values in iterator interval.</p>
<p><em>src = ['Dense' / 'Sparse' / 'Array' track], func = "sum", params =
NULL</em> <br> Sum of track values in iterator interval.</p>
<p><em>src = ['Dense' / 'Sparse' / 'Array' track], func = "quantile", params
= [Percentile in the range of [0, 1]]</em> <br> Quantile of track values in
iterator interval.</p>
<p><em>src = ['Dense' track], func = "global.percentile", params = NULL</em> <br>
Percentile of an average track value in iterator interval relatively to all
values of the track.</p>
<p><em>src = ['Dense' track], func = "global.percentile.max", params = NULL</em>
<br> Percentile of a maximal track value in iterator interval relatively to
all values of the track.</p>
<p><em>src = ['Dense' track], func = "global.percentile.min", params = NULL</em>
<br> Percentile of a minimal track value in iterator interval relatively to
all values of the track.</p>
<p><em>src = [2D track], func = "area", params = NULL</em> <br> Area covered by
iterator interval.</p>
<p><em>src = [2D track], func = "weighted.sum", params = NULL</em> <br> Weighted
sum of values where each weight equals to the intersection area between the
iterator interval and the rectangle containing the value.</p>
<p><em>src = [1D intervals], func = "distance", params = [Minimal distance
from center (default: 0)]</em> <br> Given the center 'C' of the current iterator
interval returns 'DC * X/2', where 'DC' is the normalized distance to the
center of the interval that contains 'C', and 'X' is the value of the
parameter. If no interval contains 'C' the resulted value is 'D + XXX/2'
where 'D' is the distance between 'C' and the edge of the closest interval.
Distance can be positive or negative depending on the position of the
coordinate relative to the interval and the strand (-1 or 1) of the
interval. Distance is always positive if 'strand' is '0' or if 'strand'
column is missing. Distance is 'NA' if no intervals exist for the current
chromosome.</p>
<p><em>src = [1D intervals], func = "distance.center", params = NULL</em> <br>
Given the center 'C' of the current iterator interval returns 'NaN' if 'C'
is outside of the intervals, otherwise returns the distance between 'C' and
the center of the closest interval. Distance can be positive or negative
depending on the position of the coordinate relative to the interval and the
strand (-1 or 1) of the interval. Distance is always positive if 'strand' is
'0' or if 'strand' column is missing.</p>
<p><em>src = [1D intervals], func = "coverage", params = NULL</em> <br>
For each iterator interval, calculates the fraction of its length that is covered by the
source intervals. Returns a value between 0 and 1. For example, if an iterator interval is [100,200]
and the source intervals cover positions 120-140 and 160-170, the coverage would be 0.3
((20 + 10) / 100 = 0.3). Overlapping source intervals are first unified.</p>
<p><em>func = "pwm", params = list(pssm = matrix, bidirect = TRUE,
prior = 0.01, extend = TRUE, spat_factor = NULL, spat_bin = NULL,
spat_min = NULL, spat_max = NULL)</em> <br>
Calculates total log-likelihood score of DNA sequence against PSSM.
Uses log-sum-exp over all positions. For bidirect=TRUE, scans both
strands. Prior adds pseudocounts, extend=TRUE allows scoring at boundaries.
Optional spatial weighting allows position-dependent weights.</p>
<p><em>func = "pwm.max", params = list(pssm = matrix, bidirect = TRUE,
prior = 0.01, extend = TRUE, spat_factor = NULL, spat_bin = NULL,
spat_min = NULL, spat_max = NULL)</em> <br>
Returns maximum log-likelihood score of best PSSM match. bidirect=TRUE
checks both strands. Prior adds pseudocounts, extend=TRUE allows boundary
scoring. Neutral characters (<code>N</code>, <code>n</code>, <code>*</code> by default) are scored with the mean
log-probability of each PSSM column on both strands, so the same penalty applies regardless of
orientation. The reported value is the single best-strand score after spatial weighting—forward
and reverse orientations are compared, not summed. Optional spatial weighting allows
position-dependent weights.</p>
<p><em>func = "pwm.max.pos", params = list(pssm = matrix, bidirect = TRUE,
prior = 0.01, extend = TRUE, spat_factor = NULL, spat_bin = NULL,
spat_min = NULL, spat_max = NULL)</em> <br>
Returns 1-based position of best PSSM match.
If bidirect=TRUE, the position would be positive if the best hit was at the
forward strand, and negative if it was at the reverse strand. When strand is
-1 the position is still according to the forward strand, but the hit is at
the end of the match.
Prior adds pseudocounts, extend=TRUE allows boundary scoring.
Optional spatial weighting allows position-dependent weights.</p>
<p><em>func = "pwm.count", params = list(pssm = matrix, score.thresh = 0,
bidirect = TRUE, prior = 0.01, extend = TRUE, strand = 1)</em> <br>
Counts motif hits with score &gt;= threshold inside each interval. Returns the
number of positions where the log-likelihood score meets or exceeds score.thresh.
For bidirect=TRUE, counts hits on both strands (each position and strand counted
separately). Prior adds pseudocounts, extend=TRUE allows scoring at boundaries.</p>
<p>For all PWM functions:</p><ul><li><p>pssm: Position-specific scoring matrix (nx4 matrix with columns A,C,G,T containing frequencies)</p></li>
<li><p>bidirect: If TRUE, scans both strands; if FALSE, forward only (default: TRUE)</p></li>
<li><p>prior: Pseudocount added to frequencies (default: 0.01). Set to 0 for no pseudocounts.</p></li>
<li><p>extend: If TRUE, allows scoring at interval boundaries (default: TRUE)</p></li>
<li><p>neutral characters: By default <code>N</code>, <code>n</code>, and <code>*</code> are treated as unknown bases
and contribute the average log-probability of the corresponding PSSM column on both strands.</p></li>
<li><p>strand: If 1, scans forward strand; if -1, scans reverse strand (default: 1).
For strand == 1, the position of the best match is at the beginning of the match.
For strand == -1, the position is at the end of the match.</p></li>
<li><p>score.thresh: Score threshold for pwm.count (default: 0). Only positions with
log-likelihood &gt;= score.thresh are counted.</p></li>
<li><p>spat_factor: Optional numeric vector of positive spatial weights (one per bin).
Weights are applied in log-space: weighted_score = log_likelihood + log(spat_factor[bin]).
If NULL (default), no spatial weighting is applied.</p></li>
<li><p>spat_bin: Integer bin size in base pairs (required if spat_factor provided).
Must be &gt; 0. Bins are 0-indexed from scan start: bin = floor(position / spat_bin).</p></li>
<li><p>spat_min: Optional 1-based position defining start of scanning window (default: 1).
Use with spat_max to restrict scanning to a specific region.</p></li>
<li><p>spat_max: Optional 1-based position defining end of scanning window (default: interval length).
Actual last scanned position may be earlier to accommodate motif length.</p></li>
</ul><p><strong>Spatial Weighting:</strong>
Enables position-dependent weighting for modeling positional biases. Bins are 0-indexed from the
scan start. When using gvtrack.iterator() shifts (e.g., sshift=-50, eshift=50), bins index from
the expanded scan window start, not the original interval. Both strands use the same bin at each
genomic position. Positions beyond the last bin use the last bin's weight. If the window size is
not divisible by spat_bin, the last bin will be smaller (e.g., 500bp window with 40bp bins creates
bins 0-11 of 40bp each, plus bin 12 of 20bp). Use spat_min and spat_max to restrict scanning to a
range divisible by spat_bin if needed.</p>
<p>PWM parameters are accepted as list or individual parameters (see examples).</p>
<p><em>func = "kmer.count", params = list(kmer = "ACGT", extend = TRUE, strand = 0)</em> <br>
Counts occurrences of the specified kmer in each interval. The extend=TRUE
parameter (default) allows counting kmers that span interval boundaries.
The strand parameter can be 1 (forward strand), -1 (reverse strand), or 0 (both strands).</p>
<p><em>func = "kmer.frac", params = list(kmer = "ACGT", extend = TRUE, strand = 0)</em> <br>
Calculates the fraction of possible positions in each interval that contain
the specified kmer. The extend=TRUE parameter (default) allows counting kmers
that span interval boundaries. The strand parameter can be 1 (forward strand), -1
(reverse strand), or 0 (both strands).</p>
<p>For kmer functions:</p><ul><li><p>kmer: The DNA sequence to count (case-insensitive)</p></li>
<li><p>extend: If TRUE, counts kmers that span interval boundaries</p></li>
<li><p>strand: If 1, counts kmers on forward strand; if -1, counts kmers on reverse strand. If
 0, counts kmers on both strands. Default is 0.</p></li>
</ul><p>Kmer parameters are accepted as list or individual parameters (see examples).
Note that for palindromic kmers, setting strand to 1 or -1 is recommended to avoid double counting.</p>
<p>Modify iterator behavior with 'gvtrack.iterator' or 'gvtrack.iterator.2d'.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gvtrack.info.html">gvtrack.info</a></code>, <code><a href="gvtrack.iterator.html">gvtrack.iterator</a></code>,
<code><a href="gvtrack.iterator.2d.html">gvtrack.iterator.2d</a></code>, <code><a href="gvtrack.array.slice.html">gvtrack.array.slice</a></code>,
<code><a href="gvtrack.ls.html">gvtrack.ls</a></code>, <code><a href="gvtrack.rm.html">gvtrack.rm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack1"</span>, <span class="st">"dense_track"</span>, <span class="st">"max"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack2"</span>, <span class="st">"dense_track"</span>, <span class="st">"quantile"</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"dense_track"</span>, <span class="st">"vtrack1"</span>, <span class="st">"vtrack2"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end dense_track vtrack1 vtrack2 intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000  0.08988887    0.20    0.06          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000  0.04100000    0.26    0.02          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000  0.04100000    0.10    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000  0.04100000    0.14    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000  0.04300000    0.18    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000  0.04000000    0.10    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000  0.05799999    0.22    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000  0.02400000    0.06    0.02          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000  0.03300000    0.10    0.03          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000  0.06899999    0.18    0.07          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack3"</span>, <span class="st">"dense_track"</span>, <span class="st">"global.percentile"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack4"</span>, <span class="st">"annotations"</span>, <span class="st">"distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdist.html">gdist</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"vtrack3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="st">"vtrack4"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">500</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     (-500,-300] (-300,-100] (-100,100] (100,300] (300,500]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0,0.111111]                  2           5         77         7         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.111111,0.222222]           0           0          0         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.222222,0.333333]           5           7         36         9         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.333333,0.444444]           5           2         32         3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.444444,0.555556]           2           2         24         2         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.555556,0.666667]           4           1         29         6         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.666667,0.777778]           0           2         29         2         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.777778,0.888889]           0           1         35         0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.888889,1]                  2           3         18         2         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000000 0.1111111 0.2222222 0.3333333 0.4444444 0.5555556 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.7777778 0.8888889 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -500 -300 -100  100  300  500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cov"</span>, <span class="st">"annotations"</span>, <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"cov"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start  end cov intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  100 0.8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   100  200 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1   200  300 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   300  400 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   400  500 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1   500  600 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1   600  700 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1   700  800 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1   800  900 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1   900 1000 1.0          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pssm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="co"># Example PSSM</span></span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pssm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"motif_score"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"max_motif_score"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="fl">0.01</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"max_motif_pos"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max.pos"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"dense_track"</span>, <span class="st">"motif_score"</span>, <span class="st">"max_motif_score"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"max_motif_pos"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end dense_track motif_score max_motif_score max_motif_pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500   0.1577778  -1.7766600       -5.326688          -146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000   0.0220000  -0.9113579       -4.131331           178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500   0.0540000  -1.3073398       -4.131331            32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000   0.0280000  -1.5331404       -4.131331           203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500   0.0420000  -1.4151770       -4.151339          -127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000   0.0400000  -0.9677289       -2.289690          -135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500   0.0320000  -1.3787558       -4.151339            22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000   0.0500000  -1.2041832       -4.151339             4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500   0.0360000  -1.0488077       -2.289690           -39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000   0.0500000  -0.9755256       -4.131331           -55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500   0.0460000  -1.4299523       -4.131331            11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000   0.0340000  -1.2019985       -4.131331            62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500   0.0800000  -1.6382432       -4.151339           152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000   0.0360000  -1.1377984       -4.131331            20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500   0.0220000  -1.0761298       -4.131331             8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000   0.0260000  -1.0666254       -4.131331           174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500   0.0320000  -0.9999040       -2.289690            75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000   0.0340000  -0.9541363       -2.289690           189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500   0.0580000  -0.8253076       -2.289690           450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000   0.0800000  -1.5154108       -4.151339          -248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kmer counting examples</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cg_count"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"CG"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cg_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"CG"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cg_count"</span>, <span class="st">"cg_frac"</span><span class="op">)</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end cg_count    cg_frac intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000       73 0.07307307          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000       27 0.02702703          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000       23 0.02302302          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000       15 0.01501502          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000       27 0.02702703          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000       25 0.02502503          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000       18 0.01801802          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000       25 0.02502503          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000       20 0.02002002          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000       24 0.02402402          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_pos"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_neg"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_both"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>kmer sequence 'AT' is palindromic, please set strand to 1 or -1 to avoid double counting</span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"at_pos"</span>, <span class="st">"at_neg"</span>, <span class="st">"at_both"</span><span class="op">)</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end at_pos at_neg at_both intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000      4      4       8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000     47     47      94          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000     28     28      56          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000     33     33      66          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000     24     24      48          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000     19     19      38          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000     34     34      68          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000     31     31      62          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000     40     40      80          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000     32     32      64          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GC content</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"g_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"c_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"g_frac + c_frac"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    colnames <span class="op">=</span> <span class="st">"gc_content"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end gc_content intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000      0.629          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000      0.522          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000      0.603          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000      0.570          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000      0.591          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000      0.622          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000      0.557          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000      0.626          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000      0.587          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000      0.565          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial PWM examples</span></span></span>
<span class="r-in"><span><span class="co"># Create a PWM with higher weight in the center of intervals</span></span></span>
<span class="r-in"><span><span class="va">pssm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pssm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial factors: low weight at edges, high in center</span></span></span>
<span class="r-in"><span><span class="co"># For 200bp intervals with 40bp bins: bins 0, 40, 80, 120, 160</span></span></span>
<span class="r-in"><span><span class="va">spatial_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"spatial_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>        bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        spat_factor <span class="op">=</span> <span class="va">spatial_weights</span>,</span></span>
<span class="r-in"><span>        spat_bin <span class="op">=</span> <span class="fl">40L</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with non-spatial PWM</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"regular_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spatial_pwm"</span>, <span class="st">"regular_pwm"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end  spatial_pwm regular_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   200 -0.180401295 -0.14769743          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   200   400 -0.313297242 -0.27115884          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1   400   600 -0.115642898 -0.13522016          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   600   800  0.140714258  0.14071436          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   800  1000  0.483688235  0.59744269          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  1000  1200 -0.338178366 -0.32684177          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  1200  1400 -0.103174366 -0.01625540          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  1400  1600  0.025533091 -0.01764358          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  1600  1800  0.125026807  0.08757097          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  1800  2000 -0.131756768 -0.01831045          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  2000  2200  0.408822775  0.39407575          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  2200  2400 -0.135601014 -0.14926907          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  2400  2600  0.066558383  0.08941928          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  2600  2800 -0.076511987 -0.10243686          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  2800  3000 -0.156360894 -0.18365008          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  3000  3200 -0.178761035 -0.09572198          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  3200  3400 -0.045558270 -0.02312588          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  3400  3600 -0.104294598 -0.18529214          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  3600  3800 -0.078706071 -0.10243695          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  3800  4000 -0.040662888  0.05026980          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  chr1  4000  4200 -0.219249636 -0.20749643          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  chr1  4200  4400  0.037398595  0.21399310          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  chr1  4400  4600  0.211920530  0.19952948          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  chr1  4600  4800 -0.177553743 -0.11072061          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  chr1  4800  5000  0.171406299  0.04122571          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  chr1  5000  5200 -0.102812022 -0.21086165          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  chr1  5200  5400 -0.168332055 -0.21505027          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  chr1  5400  5600 -0.224750787 -0.28187022          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  chr1  5600  5800 -0.261454254 -0.22261977          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  chr1  5800  6000  0.098980233  0.02286749          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  chr1  6000  6200 -0.152791351 -0.16430227          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  chr1  6200  6400  0.009539558 -0.05986607          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  chr1  6400  6600 -0.003595080 -0.01348370          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  chr1  6600  6800  0.154161140  0.10842018          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  chr1  6800  7000  0.536666572  0.53904849          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  chr1  7000  7200 -0.154779315 -0.17233880          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  chr1  7200  7400  0.234409109  0.21766275          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  chr1  7400  7600  0.004531109  0.02222752          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  chr1  7600  7800 -0.358309597 -0.28187087          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  chr1  7800  8000 -0.037822112 -0.06488658          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  chr1  8000  8200 -0.123648971 -0.06131697          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  chr1  8200  8400 -0.065596476 -0.05483532          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  chr1  8400  8600  0.300766706  0.43346265          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  chr1  8600  8800  0.233623102  0.16052406          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  chr1  8800  9000  0.043814570  0.05156638          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  chr1  9000  9200  0.534710228  0.34400526          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  chr1  9200  9400 -0.122906998 -0.13060562          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  chr1  9400  9600  0.076439023  0.26928064          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  chr1  9600  9800 -0.048390523  0.02025015          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  chr1  9800 10000 -0.175185129 -0.17636901          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using spatial parameters with iterator shifts</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"spatial_extended"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    spat_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    spat_bin <span class="op">=</span> <span class="fl">40L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Scan window will be 280bp (100bp + 2*90bp)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gvtrack.iterator.html">gvtrack.iterator</a></span><span class="op">(</span><span class="st">"spatial_extended"</span>, sshift <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, eshift <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"spatial_extended"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     chrom start   end spatial_extended intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    chr1     0   100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    chr1   100   200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    chr1   200   300       -2.6984816          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    chr1   300   400       -3.6469755          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    chr1   400   500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    chr1   500   600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    chr1   600   700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    chr1   700   800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    chr1   800   900       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   chr1   900  1000        0.0825938          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   chr1  1000  1100       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   chr1  1100  1200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   chr1  1200  1300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   chr1  1300  1400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   chr1  1400  1500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   chr1  1500  1600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   chr1  1600  1700       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   chr1  1700  1800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   chr1  1800  1900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   chr1  1900  2000       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   chr1  2000  2100       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   chr1  2100  2200       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   chr1  2200  2300       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   chr1  2300  2400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   chr1  2400  2500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   chr1  2500  2600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   chr1  2600  2700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   chr1  2700  2800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   chr1  2800  2900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   chr1  2900  3000       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   chr1  3000  3100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32   chr1  3100  3200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33   chr1  3200  3300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34   chr1  3300  3400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35   chr1  3400  3500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36   chr1  3500  3600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37   chr1  3600  3700       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   chr1  3700  3800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   chr1  3800  3900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40   chr1  3900  4000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   chr1  4000  4100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   chr1  4100  4200       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   chr1  4200  4300       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   chr1  4300  4400       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   chr1  4400  4500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   chr1  4500  4600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47   chr1  4600  4700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48   chr1  4700  4800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49   chr1  4800  4900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50   chr1  4900  5000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51   chr1  5000  5100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52   chr1  5100  5200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53   chr1  5200  5300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54   chr1  5300  5400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55   chr1  5400  5500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56   chr1  5500  5600       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57   chr1  5600  5700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58   chr1  5700  5800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59   chr1  5800  5900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60   chr1  5900  6000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61   chr1  6000  6100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62   chr1  6100  6200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63   chr1  6200  6300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64   chr1  6300  6400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65   chr1  6400  6500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66   chr1  6500  6600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67   chr1  6600  6700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68   chr1  6700  6800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69   chr1  6800  6900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70   chr1  6900  7000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71   chr1  7000  7100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72   chr1  7100  7200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73   chr1  7200  7300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74   chr1  7300  7400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75   chr1  7400  7500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76   chr1  7500  7600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77   chr1  7600  7700       -2.6984816          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78   chr1  7700  7800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79   chr1  7800  7900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80   chr1  7900  8000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81   chr1  8000  8100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82   chr1  8100  8200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83   chr1  8200  8300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84   chr1  8300  8400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85   chr1  8400  8500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86   chr1  8500  8600       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87   chr1  8600  8700       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88   chr1  8700  8800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89   chr1  8800  8900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90   chr1  8900  9000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91   chr1  9000  9100       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92   chr1  9100  9200       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93   chr1  9200  9300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94   chr1  9300  9400       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95   chr1  9400  9500       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96   chr1  9500  9600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97   chr1  9600  9700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98   chr1  9700  9800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99   chr1  9800  9900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  chr1  9900 10000       -2.0053344          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using spat_min/spat_max to restrict scanning to a window</span></span></span>
<span class="r-in"><span><span class="co"># For 500bp intervals, scan only positions 30-470 (440bp window)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"window_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    spat_min <span class="op">=</span> <span class="fl">30</span>, <span class="co"># 1-based position</span></span></span>
<span class="r-in"><span>    spat_max <span class="op">=</span> <span class="fl">470</span> <span class="co"># 1-based position</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"window_pwm"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end window_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500  0.5735642          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000  1.0993481          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500  0.6392633          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000  0.8320076          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500  0.8932194          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000  0.6802183          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500  0.6951929          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000  0.7342756          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500  0.8058116          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000  0.8210365          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500  0.5609012          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000  0.6062216          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500  0.6843141          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000  1.0550114          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500  0.7978341          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000  0.7205436          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500  0.7662507          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000  1.0681937          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500  1.0339503          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000  0.7142714          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combining spatial weighting with window restriction</span></span></span>
<span class="r-in"><span><span class="co"># Scan positions 50-450 with spatial weights favoring the center</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"window_spatial_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    spat_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    spat_bin <span class="op">=</span> <span class="fl">40L</span>,</span></span>
<span class="r-in"><span>    spat_min <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    spat_max <span class="op">=</span> <span class="fl">450</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"window_spatial_pwm"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end window_spatial_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500          0.6662649          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000          1.0076195          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500          0.6896264          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000          0.9325658          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500          0.9136872          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000          0.7101454          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500          0.8078918          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000          0.7714566          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500          0.9492366          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000          0.7719353          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500          0.5994186          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000          0.6014619          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500          0.7587075          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000          1.0583302          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500          0.9049065          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000          0.6299857          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500          0.7886878          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000          1.1660963          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500          0.9576775          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000          0.7346372          1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

