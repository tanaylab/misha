<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Creates a new virtual track — gvtrack.create • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a new virtual track — gvtrack.create"><meta property="og:description" content="Creates a new virtual track."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Database-Formats.html">Database Formats and Multi-Contig Support</a>
    </li>
    <li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Creates a new virtual track</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/vtrack.R" class="external-link"><code>R/vtrack.R</code></a></small>
    <div class="hidden name"><code>gvtrack.create.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a new virtual track.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gvtrack.create</span><span class="op">(</span></span>
<span>  vtrack <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  src <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  func <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sshift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eshift <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-vtrack">vtrack<a class="anchor" aria-label="anchor" href="#arg-vtrack"></a></dt>
<dd><p>virtual track name</p></dd>


<dt id="arg-src">src<a class="anchor" aria-label="anchor" href="#arg-src"></a></dt>
<dd><p>source (track/intervals). NULL for PWM functions. For value-based
tracks, provide a data frame with columns <code>chrom</code>, <code>start</code>, <code>end</code>,
and one numeric value column. The data frame functions as an in-memory sparse
track and supports all track-based summarizer functions. Intervals must not overlap.</p></dd>


<dt id="arg-func">func<a class="anchor" aria-label="anchor" href="#arg-func"></a></dt>
<dd><p>function name (see above)</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>function parameters (see above)</p></dd>


<dt id="arg-dim">dim<a class="anchor" aria-label="anchor" href="#arg-dim"></a></dt>
<dd><p>use 'NULL' or '0' for 1D iterators. '1' converts 2D iterator to
(chrom1, start1, end1) , '2' converts 2D iterator to (chrom2, start2, end2)</p></dd>


<dt id="arg-sshift">sshift<a class="anchor" aria-label="anchor" href="#arg-sshift"></a></dt>
<dd><p>shift of 'start' coordinate</p></dd>


<dt id="arg-eshift">eshift<a class="anchor" aria-label="anchor" href="#arg-eshift"></a></dt>
<dd><p>shift of 'end' coordinate</p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>genomic mask to apply. Can be:</p><ul><li><p>A data.frame with columns 'chrom', 'start', 'end' (intervals to mask)</p></li>
<li><p>A character string naming an intervals set</p></li>
<li><p>A character string naming a track (must be intervals-type track)</p></li>
<li><p>A list of any combination of the above (all will be unified)</p></li>
<li><p>NULL to clear the filter</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional PWM parameters</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>None.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function creates a new virtual track named 'vtrack' with the given
source, function and parameters. 'src' can be either a track, intervals
(1D or 2D), or a data frame with intervals and a numeric value column
(value-based track). The tables below summarize the supported combinations.</p>
<p><strong>Value-based tracks</strong>
Value-based tracks are data frames containing genomic intervals with associated
numeric values. They function as in-memory sparse tracks without requiring
track creation in the database. To create a value-based track, provide a data
frame with columns <code>chrom</code>, <code>start</code>, <code>end</code>, and one numeric
value column (any name is acceptable). Value-based tracks support all track-based
summarizer functions (e.g., <code>avg</code>, <code>min</code>, <code>max</code>, <code>sum</code>,
<code>stddev</code>, <code>quantile</code>, <code>nearest</code>, <code>exists</code>, <code>size</code>,
<code>first</code>, <code>last</code>, <code>sample</code>, and position functions), but do not
support overlapping intervals. They behave like sparse tracks in aggregation:
values are aggregated using count-based averaging (each interval contributes equally
regardless of length), not coverage-based averaging.</p>
<p><strong>Track-based summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>params</td><td>Description</td></tr><tr><td>Track</td><td>avg</td><td>NULL</td><td>Average track value in the iterator interval.</td></tr><tr><td>Track (1D)</td><td>exists</td><td>vals (optional)</td><td>Returns 1 if any value exists (or specific vals if provided), 0 otherwise.</td></tr><tr><td>Track (1D)</td><td>first</td><td>NULL</td><td>First value in the iterator interval.</td></tr><tr><td>Track (1D)</td><td>last</td><td>NULL</td><td>Last value in the iterator interval.</td></tr><tr><td>Track</td><td>max</td><td>NULL</td><td>Maximum track value in the iterator interval.</td></tr><tr><td>Track</td><td>min</td><td>NULL</td><td>Minimum track value in the iterator interval.</td></tr><tr><td>Dense / Sparse / Array track</td><td>nearest</td><td>NULL</td><td>Average value inside the iterator; for sparse tracks with no samples in the interval, falls back to the closest sample outside the interval (by genomic distance).</td></tr><tr><td>Track (1D)</td><td>sample</td><td>NULL</td><td>Uniformly sampled source value from the iterator interval.</td></tr><tr><td>Track (1D)</td><td>size</td><td>NULL</td><td>Number of non-NaN values in the iterator interval.</td></tr><tr><td>Dense / Sparse / Array track</td><td>stddev</td><td>NULL</td><td>Unbiased standard deviation of values in the iterator interval.</td></tr><tr><td>Dense / Sparse / Array track</td><td>sum</td><td>NULL</td><td>Sum of values in the iterator interval.</td></tr><tr><td>Dense / Sparse / Array track</td><td>quantile</td><td>Percentile in [0, 1]</td><td>Quantile of values in the iterator interval.</td></tr><tr><td>Dense track</td><td>global.percentile</td><td>NULL</td><td>Percentile of the interval average relative to the full-track distribution.</td></tr><tr><td>Dense track</td><td>global.percentile.max</td><td>NULL</td><td>Percentile of the interval maximum relative to the full-track distribution.</td></tr><tr><td>Dense track</td><td>global.percentile.min</td><td>NULL</td><td>Percentile of the interval minimum relative to the full-track distribution.</td></tr></table><p><strong>Track position summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>params</td><td>Description</td></tr><tr><td>Track (1D)</td><td>first.pos.abs</td><td>NULL</td><td>Absolute genomic coordinate of the first value.</td></tr><tr><td>Track (1D)</td><td>first.pos.relative</td><td>NULL</td><td>Zero-based position (relative to interval start) of the first value.</td></tr><tr><td>Track (1D)</td><td>last.pos.abs</td><td>NULL</td><td>Absolute genomic coordinate of the last value.</td></tr><tr><td>Track (1D)</td><td>last.pos.relative</td><td>NULL</td><td>Zero-based position (relative to interval start) of the last value.</td></tr><tr><td>Track (1D)</td><td>max.pos.abs</td><td>NULL</td><td>Absolute genomic coordinate of the maximum value inside the iterator interval.</td></tr><tr><td>Track (1D)</td><td>max.pos.relative</td><td>NULL</td><td>Zero-based position (relative to interval start) of the maximum value.</td></tr><tr><td>Track (1D)</td><td>min.pos.abs</td><td>NULL</td><td>Absolute genomic coordinate of the minimum value inside the iterator interval.</td></tr><tr><td>Track (1D)</td><td>min.pos.relative</td><td>NULL</td><td>Zero-based position (relative to interval start) of the minimum value.</td></tr><tr><td>Track (1D)</td><td>sample.pos.abs</td><td>NULL</td><td>Absolute genomic coordinate of a uniformly sampled value.</td></tr><tr><td>Track (1D)</td><td>sample.pos.relative</td><td>NULL</td><td>Zero-based position (relative to interval start) of a uniformly sampled value.</td></tr></table><p>For <code>max.pos.relative</code>, <code>min.pos.relative</code>, <code>first.pos.relative</code>, <code>last.pos.relative</code>, <code>sample.pos.relative</code>,
iterator modifiers (including <code>sshift</code> /
<code>eshift</code> and 1D projections generated via <code>gvtrack.iterator</code>) are
applied before the position is reported. In other words, the returned
coordinate is always 0-based and measured from the start of the iterator
interval after all modifier adjustments.</p>
<p><strong>Interval-based summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>params</td><td>Description</td></tr><tr><td>1D intervals</td><td>distance</td><td>Minimal distance from center (default 0)</td><td>Signed distance using normalized formula when inside intervals, distance to edge when outside; see notes below for exact formula.</td></tr><tr><td>1D intervals</td><td>distance.center</td><td>NULL</td><td>Distance from iterator center to the closest interval center, <code>NA</code> if outside all intervals.</td></tr><tr><td>1D intervals</td><td>distance.edge</td><td>NULL</td><td>Edge-to-edge distance from iterator interval to closest source interval (like <code>gintervals.neighbors</code>); see notes below for strand handling.</td></tr><tr><td>1D intervals</td><td>coverage</td><td>NULL</td><td>Fraction of iterator length covered by source intervals (after unifying overlaps).</td></tr><tr><td>1D intervals</td><td>neighbor.count</td><td>Max distance (&gt;= 0)</td><td>Number of source intervals whose edge-to-edge distance from the iterator interval is within params (no unification).</td></tr></table><p><strong>2D track summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>params</td><td>Description</td></tr><tr><td>2D track</td><td>area</td><td>NULL</td><td>Area covered by intersections of track rectangles with the iterator interval.</td></tr><tr><td>2D track</td><td>weighted.sum</td><td>NULL</td><td>Weighted sum of values where each weight equals the intersection area.</td></tr></table><p><strong>Motif (PWM) summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>Key params</td><td>Description</td></tr><tr><td>NULL (sequence)</td><td>pwm</td><td>pssm, bidirect, prior, extend, spat_*</td><td>Log-sum-exp score of motif likelihoods across all anchors inside the iterator interval.</td></tr><tr><td>NULL (sequence)</td><td>pwm.max</td><td>pssm, bidirect, prior, extend, spat_*</td><td>Maximum log-likelihood score among all anchors (per-position union across strands).</td></tr><tr><td>NULL (sequence)</td><td>pwm.max.pos</td><td>pssm, bidirect, prior, extend, spat_*</td><td>1-based position of the best-scoring anchor (signed by strand when <code>bidirect = TRUE</code>); coordinates are always relative to the iterator interval after any <code><a href="gvtrack.iterator.html">gvtrack.iterator()</a></code> shifts/extensions.</td></tr><tr><td>NULL (sequence)</td><td>pwm.count</td><td>pssm, score.thresh, bidirect, prior, extend, strand, spat_*</td><td>Count of anchors whose score exceeds <code>score.thresh</code> (per-position union).</td></tr></table><p><strong>K-mer summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>Key params</td><td>Description</td></tr><tr><td>NULL (sequence)</td><td>kmer.count</td><td>kmer, extend, strand</td><td>Number of k-mer occurrences whose anchor lies inside the iterator interval.</td></tr><tr><td>NULL (sequence)</td><td>kmer.frac</td><td>kmer, extend, strand</td><td>Fraction of possible anchors within the interval that match the k-mer.</td></tr></table><p><strong>Masked sequence summarizers</strong></p><table class="table table"><tr><td>Source</td><td>func</td><td>Key params</td><td>Description</td></tr><tr><td>NULL (sequence)</td><td>masked.count</td><td>NULL</td><td>Number of masked (lowercase) base pairs in the iterator interval.</td></tr><tr><td>NULL (sequence)</td><td>masked.frac</td><td>NULL</td><td>Fraction of base pairs in the iterator interval that are masked (lowercase).</td></tr></table><p>The sections below provide additional notes for motif, interval, k-mer, and masked sequence functions.</p>
<p><strong>Motif (PWM) notes</strong></p><ul><li><p><code>pssm</code>: Position-specific scoring matrix (matrix or data frame) with columns <code>A</code>, <code>C</code>, <code>G</code>, <code>T</code>; extra columns are ignored.</p></li>
<li><p><code>bidirect</code>: When TRUE (default), both strands are scanned and combined per genomic start (per-position union). The <code>strand</code> argument is ignored. When FALSE, only the strand specified by <code>strand</code> is scanned.</p></li>
<li><p><code>prior</code>: Pseudocount added to frequencies (default 0.01). Set to 0 to disable.</p></li>
<li><p><code>extend</code>: Extends the fetched sequence so boundary-anchored motifs retain full context (default TRUE). The END coordinate is padded by motif_length - 1 for all strand modes; anchors must still start inside the iterator.</p></li>
<li><p>Neutral characters (<code>N</code>, <code>n</code>, <code>*</code>) contribute the mean log-probability of the corresponding PSSM column on both strands.</p></li>
<li><p><code>strand</code>: Used only when <code>bidirect = FALSE</code>; 1 scans the forward strand, -1 scans the reverse strand. For <code>pwm.max.pos</code>, strand = -1 reports the hit position at the end of the match (still relative to the forward orientation).</p></li>
<li><p><code>score.thresh</code>: Threshold for <code>pwm.count</code>. Anchors with log-likelihood &gt;= <code>score.thresh</code> are counted; only one count per genomic start.</p></li>
<li><p>Spatial weighting (<code>spat_factor</code>, <code>spat_bin</code>, <code>spat_min</code>, <code>spat_max</code>): optional position-dependent weights applied in log-space. Provide a positive numeric vector <code>spat_factor</code>; <code>spat_bin</code> (integer &gt; 0) defines bin width; <code>spat_min</code>/<code>spat_max</code> restrict the scanning window.</p></li>
<li><p><code>pwm.max.pos</code>: Positions are reported 1-based relative to the final scan window (after iterator shifts and spatial trimming). Ties resolve to the most 5' anchor; the forward strand wins ties at the same coordinate. Values are signed when <code>bidirect = TRUE</code> (positive for forward, negative for reverse).</p></li>
</ul><p><strong>Spatial weighting</strong>
enables position-dependent weighting for modeling positional biases. Bins are 0-indexed from the
scan start. When using <code><a href="gvtrack.iterator.html">gvtrack.iterator()</a></code> shifts (e.g., <code>sshift = -50</code>, <code>eshift = 50</code>), bins index from
the expanded scan window start, not the original interval. Both strands use the same bin at each
genomic position. Positions beyond the last bin reuse the final bin's weight. If the window size is
not divisible by <code>spat_bin</code>, the last bin is shorter (e.g., scanning 500 bp with 40 bp bins yields
bins 0-11 of 40 bp plus bin 12 of 20 bp). Use <code>spat_min</code> and <code>spat_max</code> to restrict scanning to a
range divisible by <code>spat_bin</code> if needed.</p>
<p>PWM parameters can be supplied either as a single list (<code>params</code>) or via named arguments (see examples).</p>
<p><strong>Interval distance notes</strong></p>
<p><code>distance</code>: Given the center 'C' of the current iterator interval, returns 'DC * X/2' where 'DC' is the normalized distance to the center of the interval that contains 'C', and 'X' is the value of the parameter (default: 0). If no interval contains 'C', the result is 'D + X/2' where 'D' is the distance between 'C' and the edge of the closest interval.</p>
<p><code>distance.center</code>: Given the center 'C' of the current iterator interval, returns <code>NaN</code> if 'C' is outside of all intervals, otherwise returns the distance between 'C' and the center of the closest interval.</p>
<p><code>distance.edge</code>: Computes edge-to-edge distance from the iterator interval to the closest source interval, using the same calculation as <code>gintervals.neighbors</code>. Returns 0 for overlapping intervals. Distance sign depends on the strand column of source intervals; returns unsigned (absolute) distance if no strand column exists. Returns <code>NA</code> if no source intervals exist on the current chromosome.</p>
<p>For <code>distance</code> and <code>distance.center</code>, distance can be positive or negative depending on the position of the coordinate relative to the interval and the strand (-1 or 1) of the interval. Distance is always positive if <code>strand = 0</code> or if the strand column is missing. The result is <code>NA</code> if no intervals exist for the current chromosome.</p>
<p><strong>Difference between distance functions:</strong> The <code>distance</code> function measures from the <em>center</em> of the iterator interval (a single coordinate point) to the closest <em>edge</em> of source intervals when outside, or returns a normalized distance within the interval when inside. The <code>distance.center</code> function measures from the center of the iterator interval to the <em>center</em> of source intervals. The <code>distance.edge</code> function measures <em>edge-to-edge</em> distance between intervals, exactly like <code>gintervals.neighbors</code>. Use <code>distance.edge</code> when you need the same distance computation as <code>gintervals.neighbors</code> within a virtual track context.</p>
<p><strong>K-mer notes</strong></p><ul><li><p><code>kmer</code>: DNA sequence (case-insensitive) to count.</p></li>
<li><p><code>extend</code>: If TRUE (default), counts kmers whose anchor lies in the interval even if the kmer extends beyond it; when FALSE, only kmers fully contained in the interval are considered.</p></li>
<li><p><code>strand</code>: 1 counts forward-strand occurrences, -1 counts reverse-strand occurrences, 0 counts both strands (default). For palindromic kmers, consider using 1 or -1 to avoid double counting.</p></li>
</ul><p>K-mer parameters can be supplied as a list or via named arguments (see examples).</p>
<p>Modify iterator behavior with 'gvtrack.iterator' or 'gvtrack.iterator.2d'.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gvtrack.info.html">gvtrack.info</a></code>, <code><a href="gvtrack.iterator.html">gvtrack.iterator</a></code>,
<code><a href="gvtrack.iterator.2d.html">gvtrack.iterator.2d</a></code>, <code><a href="gvtrack.array.slice.html">gvtrack.array.slice</a></code>,
<code><a href="gvtrack.ls.html">gvtrack.ls</a></code>, <code><a href="gvtrack.rm.html">gvtrack.rm</a></code></p>
<p><code><a href="gvtrack.iterator.html">gvtrack.iterator</a></code>, <code><a href="gvtrack.iterator.2d.html">gvtrack.iterator.2d</a></code>, <code><a href="gvtrack.filter.html">gvtrack.filter</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack1"</span>, <span class="st">"dense_track"</span>, <span class="st">"max"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack2"</span>, <span class="st">"dense_track"</span>, <span class="st">"quantile"</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"dense_track"</span>, <span class="st">"vtrack1"</span>, <span class="st">"vtrack2"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end dense_track vtrack1 vtrack2 intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000  0.08988887    0.20    0.06          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000  0.04100000    0.26    0.02          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000  0.04100000    0.10    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000  0.04100000    0.14    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000  0.04300000    0.18    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000  0.04000000    0.10    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000  0.05799999    0.22    0.04          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000  0.02400000    0.06    0.02          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000  0.03300000    0.10    0.03          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000  0.06899999    0.18    0.07          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack3"</span>, <span class="st">"dense_track"</span>, <span class="st">"global.percentile"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"vtrack4"</span>, <span class="st">"annotations"</span>, <span class="st">"distance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdist.html">gdist</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"vtrack3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, l <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>, <span class="st">"vtrack4"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">500</span>, <span class="fl">500</span>, <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     (-500,-300] (-300,-100] (-100,100] (100,300] (300,500]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0,0.111111]                  2           5         77         7         8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.111111,0.222222]           0           0          0         0         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.222222,0.333333]           5           7         36         9         7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.333333,0.444444]           5           2         32         3         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.444444,0.555556]           2           2         24         2         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.555556,0.666667]           4           1         29         6         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.666667,0.777778]           0           2         29         2         4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.777778,0.888889]           0           1         35         0         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.888889,1]                  2           3         18         2         3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")[[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000000 0.1111111 0.2222222 0.3333333 0.4444444 0.5555556 0.6666667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.7777778 0.8888889 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"breaks")[[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -500 -300 -100  100  300  500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cov"</span>, <span class="st">"annotations"</span>, <span class="st">"coverage"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"cov"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start  end cov intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  100 0.8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   100  200 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1   200  300 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   300  400 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   400  500 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1   500  600 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1   600  700 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1   700  800 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1   800  900 1.0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1   900 1000 1.0          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pssm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="co"># Example PSSM</span></span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pssm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"motif_score"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"max_motif_score"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span>, prior <span class="op">=</span> <span class="fl">0.01</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"max_motif_pos"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max.pos"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="st">"dense_track"</span>, <span class="st">"motif_score"</span>, <span class="st">"max_motif_score"</span>,</span></span>
<span class="r-in"><span>        <span class="st">"max_motif_pos"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end dense_track motif_score max_motif_score max_motif_pos</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500   0.1577778  -1.7766492       -5.326688          -146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000   0.0220000  -0.9113593       -4.131331           178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500   0.0540000  -1.3073429       -4.131331            32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000   0.0280000  -1.5331372       -4.131331           203</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500   0.0420000  -1.4151751       -4.151339          -127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000   0.0400000  -0.9677328       -2.289690          -135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500   0.0320000  -1.3787566       -4.151339            22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000   0.0500000  -1.2041818       -4.151339             4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500   0.0360000  -1.0488112       -2.289690           -39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000   0.0500000  -0.9755265       -4.131331           -55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500   0.0460000  -1.4299539       -4.131331            11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000   0.0340000  -1.2019985       -4.131331            62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500   0.0800000  -1.6382387       -4.151339           152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000   0.0360000  -1.1377999       -4.131331            20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500   0.0220000  -1.0761303       -4.131331             8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000   0.0260000  -1.0666244       -4.131331           174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500   0.0320000  -0.9999073       -2.289690            75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000   0.0340000  -0.9541373       -2.289690           189</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500   0.0580000  -0.8253099       -2.289690           450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000   0.0800000  -1.5154095       -4.151339          -248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kmer counting examples</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cg_count"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"CG"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"cg_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"CG"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cg_count"</span>, <span class="st">"cg_frac"</span><span class="op">)</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end cg_count    cg_frac intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000       73 0.07307307          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000       27 0.02702703          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000       23 0.02302302          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000       15 0.01501502          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000       27 0.02702703          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000       25 0.02502503          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000       18 0.01801802          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000       25 0.02502503          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000       20 0.02002002          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000       24 0.02402402          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_pos"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_neg"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"at_both"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.count"</span>, kmer <span class="op">=</span> <span class="st">"AT"</span>, strand <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>kmer sequence 'AT' is palindromic, please set strand to 1 or -1 to avoid double counting</span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"at_pos"</span>, <span class="st">"at_neg"</span>, <span class="st">"at_both"</span><span class="op">)</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end at_pos at_neg at_both intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000      4      4       8          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000     47     47      94          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000     28     28      56          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000     33     33      66          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000     24     24      48          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000     19     19      38          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000     34     34      68          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000     31     31      62          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000     40     40      80          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000     32     32      64          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GC content</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"g_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"c_frac"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"g_frac + c_frac"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    colnames <span class="op">=</span> <span class="st">"gc_content"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end gc_content intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000      0.629          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000      0.522          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000      0.603          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000      0.570          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000      0.591          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000      0.622          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000      0.557          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000      0.626          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000      0.587          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000      0.565          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Masked base pair counting</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"masked_count"</span>, <span class="cn">NULL</span>, <span class="st">"masked.count"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"masked_frac"</span>, <span class="cn">NULL</span>, <span class="st">"masked.frac"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"masked_count"</span>, <span class="st">"masked_frac"</span><span class="op">)</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end masked_count masked_frac intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000         1000       1.000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000          604       0.604          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000            0       0.000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000            0       0.000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000            0       0.000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000           91       0.091          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000           37       0.037          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000            0       0.000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000          143       0.143          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000          190       0.190          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combined with GC content (unmasked regions only)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"gc"</span>, <span class="cn">NULL</span>, <span class="st">"kmer.frac"</span>, kmer <span class="op">=</span> <span class="st">"G"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"gc * (1 - masked_frac)"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    colnames <span class="op">=</span> <span class="st">"gc_unmasked"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end gc_unmasked intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000   0.0000000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000   0.1033560          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000   0.3015000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000   0.2850000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000   0.2955000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000   0.2826990          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000   0.2681955          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000   0.3130000          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000   0.2515295          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000   0.2288250          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Value-based track examples</span></span></span>
<span class="r-in"><span><span class="co"># Create a data frame with intervals and numeric values</span></span></span>
<span class="r-in"><span><span class="va">intervals_with_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chrom <span class="op">=</span> <span class="st">"chr1"</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">300</span>, <span class="fl">500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">400</span>, <span class="fl">600</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Use as value-based sparse track (functions like sparse track)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"value_track"</span>, <span class="va">intervals_with_values</span>, <span class="st">"avg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span><span class="st">"value_track_max"</span>, <span class="va">intervals_with_values</span>, <span class="st">"max"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"value_track"</span>, <span class="st">"value_track_max"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end value_track value_track_max intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  1000          20              30          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1  1000  2000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  2000  3000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  3000  4000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  4000  5000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  5000  6000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  6000  7000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  7000  8000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  8000  9000         NaN             NaN          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  9000 10000         NaN             NaN          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial PWM examples</span></span></span>
<span class="r-in"><span><span class="co"># Create a PWM with higher weight in the center of intervals</span></span></span>
<span class="r-in"><span><span class="va">pssm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>        <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    ncol <span class="op">=</span> <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pssm</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Spatial factors: low weight at edges, high in center</span></span></span>
<span class="r-in"><span><span class="co"># For 200bp intervals with 40bp bins: bins 0, 40, 80, 120, 160</span></span></span>
<span class="r-in"><span><span class="va">spatial_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"spatial_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>        bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>        spat_factor <span class="op">=</span> <span class="va">spatial_weights</span>,</span></span>
<span class="r-in"><span>        spat_bin <span class="op">=</span> <span class="fl">40L</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with non-spatial PWM</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"regular_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pssm <span class="op">=</span> <span class="va">pssm</span>, bidirect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spatial_pwm"</span>, <span class="st">"regular_pwm"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end  spatial_pwm regular_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   200 -0.180401430 -0.14769733          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   200   400 -0.313297242 -0.27115873          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1   400   600 -0.115642898 -0.13521937          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   600   800  0.140714258  0.14071478          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   800  1000  0.483688235  0.59744269          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  1000  1200 -0.338178366 -0.32684132          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  1200  1400 -0.103174366 -0.01625533          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  1400  1600  0.025533091 -0.01764396          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  1600  1800  0.125026807  0.08757108          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  1800  2000 -0.131756768 -0.01831027          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  2000  2200  0.408822775  0.39407605          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  2200  2400 -0.135601014 -0.14926806          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  2400  2600  0.066558383  0.08941976          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  2600  2800 -0.076511987 -0.10243648          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  2800  3000 -0.156360894 -0.18365006          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  3000  3200 -0.178761035 -0.09572130          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  3200  3400 -0.045558270 -0.02312547          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  3400  3600 -0.104294598 -0.18529195          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  3600  3800 -0.078706071 -0.10243648          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  3800  4000 -0.040662888  0.05026907          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  chr1  4000  4200 -0.219249636 -0.20749611          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  chr1  4200  4400  0.037398595  0.21399346          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  chr1  4400  4600  0.211920530  0.19952914          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  chr1  4600  4800 -0.177553743 -0.11072104          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  chr1  4800  5000  0.171406299  0.04122563          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  chr1  5000  5200 -0.102812022 -0.21086201          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  chr1  5200  5400 -0.168332055 -0.21505040          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  chr1  5400  5600 -0.224750787 -0.28187045          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  chr1  5600  5800 -0.261454254 -0.22261991          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  chr1  5800  6000  0.098980233  0.02286761          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  chr1  6000  6200 -0.152791351 -0.16430125          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  chr1  6200  6400  0.009539558 -0.05986627          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  chr1  6400  6600 -0.003595080 -0.01348384          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  chr1  6600  6800  0.154161140  0.10841974          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  chr1  6800  7000  0.536666572  0.53904897          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36  chr1  7000  7200 -0.154779315 -0.17233904          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  chr1  7200  7400  0.234409109  0.21766372          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  chr1  7400  7600  0.004531109  0.02222776          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  chr1  7600  7800 -0.358309597 -0.28187045          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  chr1  7800  8000 -0.037822112 -0.06488629          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  chr1  8000  8200 -0.123648971 -0.06131684          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  chr1  8200  8400 -0.065596476 -0.05483555          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  chr1  8400  8600  0.300766706  0.43346265          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  chr1  8600  8800  0.233623102  0.16052382          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  chr1  8800  9000  0.043814570  0.05156659          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  chr1  9000  9200  0.534710228  0.34400457          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  chr1  9200  9400 -0.122906998 -0.13060568          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  chr1  9400  9600  0.076439023  0.26928109          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  chr1  9600  9800 -0.048390523  0.02025047          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  chr1  9800 10000 -0.175185129 -0.17636883          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using spatial parameters with iterator shifts</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"spatial_extended"</span>, <span class="cn">NULL</span>, <span class="st">"pwm.max"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    spat_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    spat_bin <span class="op">=</span> <span class="fl">40L</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Scan window will be 280bp (100bp + 2*90bp)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gvtrack.iterator.html">gvtrack.iterator</a></span><span class="op">(</span><span class="st">"spatial_extended"</span>, sshift <span class="op">=</span> <span class="op">-</span><span class="fl">90</span>, eshift <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"spatial_extended"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     chrom start   end spatial_extended intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    chr1     0   100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    chr1   100   200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    chr1   200   300       -2.6984816          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    chr1   300   400       -3.6469755          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5    chr1   400   500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6    chr1   500   600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7    chr1   600   700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8    chr1   700   800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9    chr1   800   900       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10   chr1   900  1000        0.0825938          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11   chr1  1000  1100       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12   chr1  1100  1200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13   chr1  1200  1300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14   chr1  1300  1400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15   chr1  1400  1500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16   chr1  1500  1600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17   chr1  1600  1700       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18   chr1  1700  1800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19   chr1  1800  1900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20   chr1  1900  2000       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21   chr1  2000  2100       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22   chr1  2100  2200       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23   chr1  2200  2300       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24   chr1  2300  2400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   chr1  2400  2500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   chr1  2500  2600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   chr1  2600  2700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28   chr1  2700  2800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29   chr1  2800  2900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30   chr1  2900  3000       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31   chr1  3000  3100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32   chr1  3100  3200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33   chr1  3200  3300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34   chr1  3300  3400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35   chr1  3400  3500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 36   chr1  3500  3600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37   chr1  3600  3700       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38   chr1  3700  3800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39   chr1  3800  3900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40   chr1  3900  4000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41   chr1  4000  4100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42   chr1  4100  4200       -0.8336970          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43   chr1  4200  4300       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44   chr1  4300  4400       -1.5268440          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45   chr1  4400  4500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46   chr1  4500  4600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47   chr1  4600  4700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48   chr1  4700  4800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49   chr1  4800  4900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50   chr1  4900  5000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51   chr1  5000  5100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52   chr1  5100  5200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53   chr1  5200  5300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54   chr1  5300  5400       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55   chr1  5400  5500       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56   chr1  5500  5600       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57   chr1  5600  5700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58   chr1  5700  5800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59   chr1  5800  5900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60   chr1  5900  6000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61   chr1  6000  6100       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62   chr1  6100  6200       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63   chr1  6200  6300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64   chr1  6300  6400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65   chr1  6400  6500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66   chr1  6500  6600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67   chr1  6600  6700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 68   chr1  6700  6800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69   chr1  6800  6900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70   chr1  6900  7000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71   chr1  7000  7100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 72   chr1  7100  7200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 73   chr1  7200  7300       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 74   chr1  7300  7400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75   chr1  7400  7500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76   chr1  7500  7600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 77   chr1  7600  7700       -2.6984816          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 78   chr1  7700  7800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79   chr1  7800  7900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80   chr1  7900  8000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81   chr1  8000  8100       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82   chr1  8100  8200       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83   chr1  8200  8300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84   chr1  8300  8400       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85   chr1  8400  8500       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86   chr1  8500  8600       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87   chr1  8600  8700       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88   chr1  8700  8800       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89   chr1  8800  8900       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90   chr1  8900  9000       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91   chr1  9000  9100       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92   chr1  9100  9200       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93   chr1  9200  9300       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94   chr1  9300  9400       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95   chr1  9400  9500       -0.1405498          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96   chr1  9500  9600       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97   chr1  9600  9700       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98   chr1  9700  9800       -1.7821908          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99   chr1  9800  9900       -2.0053344          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100  chr1  9900 10000       -2.0053344          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using spat_min/spat_max to restrict scanning to a window</span></span></span>
<span class="r-in"><span><span class="co"># For 500bp intervals, scan only positions 30-470 (440bp window)</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"window_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    spat_min <span class="op">=</span> <span class="fl">30</span>, <span class="co"># 1-based position</span></span></span>
<span class="r-in"><span>    spat_max <span class="op">=</span> <span class="fl">470</span> <span class="co"># 1-based position</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"window_pwm"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end window_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500  0.5735636          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000  1.0993481          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500  0.6392645          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000  0.8320074          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500  0.8932184          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000  0.6802177          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500  0.6951929          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000  0.7342752          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500  0.8058116          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000  0.8210369          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500  0.5609006          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000  0.6062215          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500  0.6843127          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000  1.0550103          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500  0.7978342          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000  0.7205425          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500  0.7662502          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000  1.0681919          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500  1.0339508          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000  0.7142706          1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combining spatial weighting with window restriction</span></span></span>
<span class="r-in"><span><span class="co"># Scan positions 50-450 with spatial weights favoring the center</span></span></span>
<span class="r-in"><span><span class="fu">gvtrack.create</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"window_spatial_pwm"</span>, <span class="cn">NULL</span>, <span class="st">"pwm"</span>,</span></span>
<span class="r-in"><span>    pssm <span class="op">=</span> <span class="va">pssm</span>,</span></span>
<span class="r-in"><span>    bidirect <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>    spat_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    spat_bin <span class="op">=</span> <span class="fl">40L</span>,</span></span>
<span class="r-in"><span>    spat_min <span class="op">=</span> <span class="fl">50</span>,</span></span>
<span class="r-in"><span>    spat_max <span class="op">=</span> <span class="fl">450</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gextract.html">gextract</a></span><span class="op">(</span><span class="st">"window_spatial_pwm"</span>, <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">10000</span><span class="op">)</span>, iterator <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start   end window_spatial_pwm intervalID</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0   500          0.6662636          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1   500  1000          1.0076195          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1  1000  1500          0.6896264          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1  1500  2000          0.9325658          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1  2000  2500          0.9136872          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1  2500  3000          0.7101454          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1  3000  3500          0.8078918          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1  3500  4000          0.7714566          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1  4000  4500          0.9492366          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1  4500  5000          0.7719353          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  5000  5500          0.5994186          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  5500  6000          0.6014619          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  6000  6500          0.7587075          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  6500  7000          1.0583302          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  7000  7500          0.9049065          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  7500  8000          0.6299857          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  chr1  8000  8500          0.7886878          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  chr1  8500  9000          1.1660963          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  chr1  9000  9500          0.9576775          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  chr1  9500 10000          0.7346372          1</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

