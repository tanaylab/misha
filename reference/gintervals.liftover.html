<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Converts intervals from another assembly — gintervals.liftover • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Converts intervals from another assembly — gintervals.liftover"><meta property="og:description" content="Converts intervals from another assembly to the current one."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Database-Formats.html">Database Formats and Multi-Contig Support</a>
    </li>
    <li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Converts intervals from another assembly</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/intervals-liftover.R" class="external-link"><code>R/intervals-liftover.R</code></a></small>
    <div class="hidden name"><code>gintervals.liftover.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Converts intervals from another assembly to the current one.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gintervals.liftover</span><span class="op">(</span></span>
<span>  intervals <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chain <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  src_overlap_policy <span class="op">=</span> <span class="st">"error"</span>,</span>
<span>  tgt_overlap_policy <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>  min_score <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  include_metadata <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  canonic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  value_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  multi_target_agg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"median"</span>, <span class="st">"sum"</span>, <span class="st">"min"</span>, <span class="st">"max"</span>, <span class="st">"count"</span>, <span class="st">"first"</span>, <span class="st">"last"</span>,</span>
<span>    <span class="st">"nth"</span>, <span class="st">"max.coverage_len"</span>, <span class="st">"min.coverage_len"</span>, <span class="st">"max.coverage_frac"</span>,</span>
<span>    <span class="st">"min.coverage_frac"</span><span class="op">)</span>,</span>
<span>  params <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_n <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-intervals">intervals<a class="anchor" aria-label="anchor" href="#arg-intervals"></a></dt>
<dd><p>intervals from another assembly</p></dd>


<dt id="arg-chain">chain<a class="anchor" aria-label="anchor" href="#arg-chain"></a></dt>
<dd><p>name of chain file or data frame as returned by
'gintervals.load_chain'</p></dd>


<dt id="arg-src-overlap-policy">src_overlap_policy<a class="anchor" aria-label="anchor" href="#arg-src-overlap-policy"></a></dt>
<dd><p>policy for handling source overlaps: "error" (default), "keep", or "discard". "keep" allows one source interval to map to multiple target intervals, "discard" discards all source intervals that have overlaps and "error" throws an error if source overlaps are detected.</p></dd>


<dt id="arg-tgt-overlap-policy">tgt_overlap_policy<a class="anchor" aria-label="anchor" href="#arg-tgt-overlap-policy"></a></dt>
<dd><p>policy for handling target overlaps. One of:</p><table class="table table"><tr><td>Policy</td><td>Description</td></tr><tr><td>error</td><td>Throws an error if any target overlaps are detected.</td></tr><tr><td>auto</td><td>Default. Alias for "auto_score".</td></tr><tr><td>auto_score</td><td>Resolves overlaps by segmenting the target region and selecting the best chain for each segment based on alignment score (highest score wins). Tie-breakers: longest span, then lowest chain_id.</td></tr><tr><td>auto_longer</td><td>Resolves overlaps by segmenting and selecting the chain with the longest span for each segment. Tie-breakers: highest score, then lowest chain_id.</td></tr><tr><td>auto_first</td><td>Resolves overlaps by segmenting and selecting the chain with the lowest chain_id for each segment.</td></tr><tr><td>keep</td><td>Preserves all overlapping intervals.</td></tr><tr><td>discard</td><td>Discards any chain interval that has a target overlap with another chain interval.</td></tr><tr><td>agg</td><td>Segments overlaps into smaller disjoint regions where each region contains all contributing chains, allowing downstream aggregation to process multiple values per region.</td></tr><tr><td>best_source_cluster</td><td>Best source cluster strategy based on source overlap. When multiple chains map a source interval, clusters them by source overlap: if chain source intervals overlap (indicating true duplications), all mappings are retained; if chain source intervals are disjoint (indicating conflicting/alternative mappings), only the cluster with the largest total target length is kept.</td></tr></table></dd>


<dt id="arg-min-score">min_score<a class="anchor" aria-label="anchor" href="#arg-min-score"></a></dt>
<dd><p>optional minimum alignment score threshold. Chains with scores below this value are filtered out. Useful for excluding low-quality alignments.</p></dd>


<dt id="arg-include-metadata">include_metadata<a class="anchor" aria-label="anchor" href="#arg-include-metadata"></a></dt>
<dd><p>logical; if TRUE, adds 'score' column to the output indicating the alignment score of the chain used for each mapping. Only applicable with "auto_score" or "auto" policy.</p></dd>


<dt id="arg-canonic">canonic<a class="anchor" aria-label="anchor" href="#arg-canonic"></a></dt>
<dd><p>logical; if TRUE, merges adjacent target intervals that originated from the same source interval (same intervalID) and same chain (same chain_id). This is useful when a source interval maps to multiple adjacent target blocks due to chain gaps.</p></dd>


<dt id="arg-value-col">value_col<a class="anchor" aria-label="anchor" href="#arg-value-col"></a></dt>
<dd><p>optional character string specifying the name of a numeric column in the intervals data frame to track through the liftover. When specified, this column's values are preserved in the output with the same column name. Use with multi_target_agg to aggregate values when multiple source intervals map to overlapping target regions.</p></dd>


<dt id="arg-multi-target-agg">multi_target_agg<a class="anchor" aria-label="anchor" href="#arg-multi-target-agg"></a></dt>
<dd><p>aggregation method to use when value_col is specified. One of: "mean", "median", "sum", "min", "max", "count", "first", "last", "nth", "max.coverage_len", "min.coverage_len", "max.coverage_frac", "min.coverage_frac". Default: "mean". Ignored when value_col is NULL.</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>additional parameters for specific aggregation methods. Currently only used for "nth" aggregation, where it specifies which element to select (e.g., params = 2 for second element, or params = list(n = 2)).</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical; if TRUE (default), NA values are removed before aggregation. If FALSE, any NA in the values will cause the result to be NA. Only used when value_col is specified.</p></dd>


<dt id="arg-min-n">min_n<a class="anchor" aria-label="anchor" href="#arg-min-n"></a></dt>
<dd><p>optional minimum number of non-NA observations required for aggregation. If fewer observations are available, the result is NA. NULL (default) means no minimum. Only used when value_col is specified.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame representing the converted intervals. For 1D intervals, always includes 'intervalID' (index of original interval) and 'chain_id' (identifier of the chain that produced the mapping) columns. The chain_id column is essential for distinguishing results when a source interval maps to multiple target regions via different chains (duplications). When include_metadata=TRUE, also includes 'score' column. When value_col is specified, includes the value column with its original name.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function converts 'intervals' from another assembly to the current one.
Chain file instructs how the conversion of coordinates should be done. It
can be either a name of a chain file or a data frame in the same format as
returned by 'gintervals.load_chain' function.</p>
<p>The converted intervals are returned. An additional column named
'intervalID' is added to the resulted data frame. For each interval in the
resulted intervals it indicates the index of the original interval.</p>
<p>Note: When passing a pre-loaded chain (data frame), overlap policies cannot
be specified - they are taken from the chain's attributes that were set
during loading. When passing a chain file path, policies can be specified
and will be used for loading.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gintervals.load_chain.html">gintervals.load_chain</a></code>, <code><a href="gtrack.liftover.html">gtrack.liftover</a></code>,
<code><a href="gintervals.html">gintervals</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">chainfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">.misha</span><span class="op">$</span><span class="va">GROOT</span>, <span class="st">"data/test.chain"</span>, sep <span class="op">=</span> <span class="st">"/"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">intervs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chrom <span class="op">=</span> <span class="st">"chr25"</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">7000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6000</span>, <span class="fl">20000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Liftover with default policies</span></span></span>
<span class="r-in"><span><span class="fu">gintervals.liftover</span><span class="op">(</span><span class="va">intervs</span>, <span class="va">chainfile</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   chrom start   end intervalID chain_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  chr1 12000 12500          1        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  chr1 12700 13500          1        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  chr1 14100 16500          1        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  chr1 17500 18500          2        1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  chrX  5000  7000          2        2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Liftover keeping source overlaps (one source interval may map to multiple targets)</span></span></span>
<span class="r-in"><span><span class="co"># gintervals.liftover(intervs, chainfile, src_overlap_policy = "keep")</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

