<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Finds neighbors between two sets of intervals — gintervals.neighbors • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Finds neighbors between two sets of intervals — gintervals.neighbors"><meta property="og:description" content="For each interval in 'intervals1', finds the closest intervals from 'intervals2'.
Distance directionality can be determined by either the strand of the target
intervals (intervals2, default) or the query intervals (intervals1). When no strand column
is present, all intervals are treated as positive strand (strand = 1)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">5.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Finds neighbors between two sets of intervals</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/neighbors.R" class="external-link"><code>R/neighbors.R</code></a></small>
    <div class="hidden name"><code>gintervals.neighbors.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For each interval in 'intervals1', finds the closest intervals from 'intervals2'.
Distance directionality can be determined by either the strand of the target
intervals (intervals2, default) or the query intervals (intervals1). When no strand column
is present, all intervals are treated as positive strand (strand = 1).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gintervals.neighbors</span><span class="op">(</span></span>
<span>  intervals1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intervals2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxneighbors <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  mindist <span class="op">=</span> <span class="op">-</span><span class="fl">1e+09</span>,</span>
<span>  maxdist <span class="op">=</span> <span class="fl">1e+09</span>,</span>
<span>  mindist1 <span class="op">=</span> <span class="op">-</span><span class="fl">1e+09</span>,</span>
<span>  maxdist1 <span class="op">=</span> <span class="fl">1e+09</span>,</span>
<span>  mindist2 <span class="op">=</span> <span class="op">-</span><span class="fl">1e+09</span>,</span>
<span>  maxdist2 <span class="op">=</span> <span class="fl">1e+09</span>,</span>
<span>  na.if.notfound <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  use_intervals1_strand <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  warn.ignored.strand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  intervals.set.out <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-intervals-intervals-">intervals1, intervals2<a class="anchor" aria-label="anchor" href="#arg-intervals-intervals-"></a></dt>
<dd><p>intervals</p></dd>


<dt id="arg-maxneighbors">maxneighbors<a class="anchor" aria-label="anchor" href="#arg-maxneighbors"></a></dt>
<dd><p>maximal number of neighbors</p></dd>


<dt id="arg-mindist-maxdist">mindist, maxdist<a class="anchor" aria-label="anchor" href="#arg-mindist-maxdist"></a></dt>
<dd><p>distance range for 1D intervals</p></dd>


<dt id="arg-mindist-maxdist-mindist-maxdist-">mindist1, maxdist1, mindist2, maxdist2<a class="anchor" aria-label="anchor" href="#arg-mindist-maxdist-mindist-maxdist-"></a></dt>
<dd><p>distance range for 2D intervals</p></dd>


<dt id="arg-na-if-notfound">na.if.notfound<a class="anchor" aria-label="anchor" href="#arg-na-if-notfound"></a></dt>
<dd><p>if 'TRUE' return 'NA' interval if no matching
neighbors were found, otherwise omit the interval in the answer</p></dd>


<dt id="arg-use-intervals-strand">use_intervals1_strand<a class="anchor" aria-label="anchor" href="#arg-use-intervals-strand"></a></dt>
<dd><p>if 'TRUE' use intervals1 strand column for
distance directionality instead of intervals2 strand. If intervals1 has no
strand column, all intervals are treated as positive strand (strand = 1).
Invalid strand values (not -1 or 1) will cause an error.</p></dd>


<dt id="arg-warn-ignored-strand">warn.ignored.strand<a class="anchor" aria-label="anchor" href="#arg-warn-ignored-strand"></a></dt>
<dd><p>if 'TRUE' (default) show warning when 'intervals1'
contains a strand column that will be ignored for distance calculation</p></dd>


<dt id="arg-intervals-set-out">intervals.set.out<a class="anchor" aria-label="anchor" href="#arg-intervals-set-out"></a></dt>
<dd><p>intervals set name where the function result is
optionally outputted</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If 'intervals.set.out' is 'NULL' a data frame containing the pairs
of intervals from 'intervals1', intervals from 'intervals2' and an
additional column named 'dist' ('dist1' and 'dist2' for 2D intervals)
representing the distance between the corresponding intervals. The intervals
from intervals2 would be changed to 'chrom1', 'start1', and 'end1' and for
2D intervals chrom11, start11, end11 and chrom22, start22, end22. If
'na.if.notfound' is 'TRUE', the data frame contains all the intervals from
'intervals1' including those for which no matching neighbor was found. For
the latter intervals an 'NA' neighboring interval is stated. If
'na.if.notfound' is 'FALSE', the data frame contains only intervals from
'intervals1' for which matching neighbor(s) was found.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function finds for each interval in 'intervals1' the closest
'maxneighbors' intervals from 'intervals2'.</p>
<p>For 1D intervals the distance must fall in the range of ['mindist',
'maxdist'].</p>
<p>**Strand handling:** By default, distance directionality is determined by the
'strand' column in 'intervals2' (if present). If 'use_intervals1_strand' is TRUE,
distance directionality is instead determined by the 'strand' column in 'intervals1'.
This is particularly useful for TSS analysis where you want upstream/downstream
distances relative to gene direction.</p>
<p>**Distance calculation modes:**</p><ul><li><p>**use_intervals1_strand = FALSE (default):** Uses intervals2 strand for directionality</p></li>
<li><p>**use_intervals1_strand = TRUE:** Uses intervals1 strand for directionality</p></li>
</ul><p>**Important:** When 'use_intervals1_strand = TRUE', distance signs are interpreted as:</p><ul><li><p>**+ strand queries:** Negative distances = upstream, Positive distances = downstream</p></li>
<li><p>**- strand queries:** Negative distances = downstream, Positive distances = upstream</p></li>
</ul><p>For 2D intervals two distances are calculated and returned for each axis.
The distances must fall in the range of ['mindist1', 'maxdist1'] for axis 1
and ['mindist2', 'maxdist2'] for axis 2. For selecting the closest
'maxneighbors' intervals Manhattan distance is used (i.e. dist1+dist2).</p>
<p>**Note:** 'use_intervals1_strand' is not yet supported for 2D intervals.</p>
<p>The names of the returned columns are made unique using
<code>make.unique(colnames(df), sep = "")</code>, assuming 'df' is the result.</p>
<p>If 'intervals.set.out' is not 'NULL' the result is saved as an intervals
set. Use this parameter if the result size exceeds the limits of the
physical memory.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gintervals.html">gintervals</a></code>, <code><a href="directional-neighbors.html">gintervals.neighbors.upstream</a></code>,
<code><a href="directional-neighbors.html">gintervals.neighbors.downstream</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic intervals</span></span></span>
<span class="r-in"><span><span class="va">intervs1</span> <span class="op">&lt;-</span> <span class="fu"><a href="giterator.intervals.html">giterator.intervals</a></span><span class="op">(</span><span class="st">"dense_track"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">4000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    iterator <span class="op">=</span> <span class="fl">233</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">intervs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="giterator.intervals.html">giterator.intervals</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"sparse_track"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="gintervals.html">gintervals</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">2000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Original behavior - no strand considerations</span></span></span>
<span class="r-in"><span><span class="fu">gintervals.neighbors</span><span class="op">(</span><span class="va">intervs1</span>, <span class="va">intervs2</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    mindist <span class="op">=</span> <span class="op">-</span><span class="fl">300</span>,</span></span>
<span class="r-in"><span>    maxdist <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start  end chrom1 start1 end1 dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  233   chr1      0   50    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1     0  233   chr1    100  150    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1     0  233   chr1    250  300   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   233  466   chr1    250  300    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   233  466   chr1    100  150   83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1   233  466   chr1      0   50  183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1   466  699   chr1    250  300  166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1   466  699   chr1    100  150  316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1   466  699   chr1      0   50  416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1   699  932   chr1    250  300  399</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1   699  932   chr1   1400 1450  468</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1   932 1165   chr1   1400 1450  235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  1165 1398   chr1   1400 1450    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  1398 1631   chr1   1400 1450    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  chr1  1631 1864   chr1   1400 1450  181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  chr1  1864 2097   chr1   1400 1450  414</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add strand to intervals2 - affects distance directionality (original behavior)</span></span></span>
<span class="r-in"><span><span class="va">intervs2</span><span class="op">$</span><span class="va">strand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gintervals.neighbors</span><span class="op">(</span><span class="va">intervs1</span>, <span class="va">intervs2</span>, <span class="fl">10</span>,</span></span>
<span class="r-in"><span>    mindist <span class="op">=</span> <span class="op">-</span><span class="fl">300</span>,</span></span>
<span class="r-in"><span>    maxdist <span class="op">=</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    chrom start  end chrom1 start1 end1 strand dist</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   chr1     0  233   chr1      0   50      1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   chr1     0  233   chr1    100  150      1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   chr1     0  233   chr1    250  300     -1   17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   chr1   233  466   chr1    250  300     -1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   chr1   233  466   chr1    100  150      1   83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   chr1   233  466   chr1      0   50      1  183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   chr1   466  699   chr1    250  300     -1 -166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   chr1   466  699   chr1    100  150      1  316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   chr1   466  699   chr1      0   50      1  416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  chr1   932 1165   chr1   1400 1450      1 -235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  chr1  1165 1398   chr1   1400 1450      1   -2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  chr1  1398 1631   chr1   1400 1450      1    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  chr1  1631 1864   chr1   1400 1450      1  181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  chr1  1864 2097   chr1   1400 1450      1  414</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># TSS analysis example - use intervals1 (TSS) strand for directionality</span></span></span>
<span class="r-in"><span><span class="va">tss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chrom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"chr1"</span>, <span class="st">"chr1"</span>, <span class="st">"chr1"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">2000</span>, <span class="fl">3000</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1001</span>, <span class="fl">2001</span>, <span class="fl">3001</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    strand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># +, -, +</span></span></span>
<span class="r-in"><span>    gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GeneA"</span>, <span class="st">"GeneB"</span>, <span class="st">"GeneC"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">features</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chrom <span class="op">=</span> <span class="st">"chr1"</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">800</span>, <span class="fl">1200</span>, <span class="fl">1800</span>, <span class="fl">2200</span>, <span class="fl">2800</span>, <span class="fl">3200</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">600</span>, <span class="fl">900</span>, <span class="fl">1300</span>, <span class="fl">1900</span>, <span class="fl">2300</span>, <span class="fl">2900</span>, <span class="fl">3300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    feature_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"F"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use TSS strand for distance directionality</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">gintervals.neighbors</span><span class="op">(</span><span class="va">tss</span>, <span class="va">features</span>,</span></span>
<span class="r-in"><span>    maxneighbors <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>    mindist <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, maxdist <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    use_intervals1_strand <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convenience functions for common TSS analysis</span></span></span>
<span class="r-in"><span><span class="co"># Find upstream neighbors (negative distances for + strand genes)</span></span></span>
<span class="r-in"><span><span class="va">upstream</span> <span class="op">&lt;-</span> <span class="fu"><a href="directional-neighbors.html">gintervals.neighbors.upstream</a></span><span class="op">(</span><span class="va">tss</span>, <span class="va">features</span>,</span></span>
<span class="r-in"><span>    maxneighbors <span class="op">=</span> <span class="fl">2</span>, maxdist <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find downstream neighbors (positive distances for + strand genes)</span></span></span>
<span class="r-in"><span><span class="va">downstream</span> <span class="op">&lt;-</span> <span class="fu"><a href="directional-neighbors.html">gintervals.neighbors.downstream</a></span><span class="op">(</span><span class="va">tss</span>, <span class="va">features</span>,</span></span>
<span class="r-in"><span>    maxneighbors <span class="op">=</span> <span class="fl">2</span>, maxdist <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Find both directions</span></span></span>
<span class="r-in"><span><span class="va">both_directions</span> <span class="op">&lt;-</span> <span class="fu"><a href="directional-neighbors.html">gintervals.neighbors.directional</a></span><span class="op">(</span><span class="va">tss</span>, <span class="va">features</span>,</span></span>
<span class="r-in"><span>    maxneighbors_upstream <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    maxneighbors_downstream <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>    maxdist <span class="op">=</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

