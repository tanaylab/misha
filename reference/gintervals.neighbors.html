<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Finds neighbors between two sets of intervals — gintervals.neighbors • misha</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Finds neighbors between two sets of intervals — gintervals.neighbors" />
<meta property="og:description" content="Finds neighbors between two sets of intervals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">4.0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/manual.pdf">
    <span class="fa fa-road"></span>
     
    User Manual
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tanaylab/misha/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Finds neighbors between two sets of intervals</h1>
    
    <div class="hidden name"><code>gintervals.neighbors.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds neighbors between two sets of intervals.</p>
    </div>

    <pre class="usage"><span class='fu'>gintervals.neighbors</span>(<span class='no'>intervals1</span>, <span class='no'>intervals2</span>, <span class='kw'>maxneighbors</span> <span class='kw'>=</span> <span class='fl'>1</span>,
                     <span class='kw'>mindist</span> <span class='kw'>=</span> -<span class='fl'>1e+09</span>, <span class='kw'>maxdist</span> <span class='kw'>=</span> <span class='fl'>1e+09</span>,
                     <span class='kw'>mindist1</span> <span class='kw'>=</span> -<span class='fl'>1e+09</span>, <span class='kw'>maxdist1</span> <span class='kw'>=</span> <span class='fl'>1e+09</span>,
                     <span class='kw'>mindist2</span> <span class='kw'>=</span> -<span class='fl'>1e+09</span>, <span class='kw'>maxdist2</span> <span class='kw'>=</span> <span class='fl'>1e+09</span>,
                     <span class='kw'>na.if.notfound</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                     <span class='kw'>intervals.set.out</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>intervals1, intervals2</th>
      <td><p>intervals</p></td>
    </tr>
    <tr>
      <th>maxneighbors</th>
      <td><p>maximal number of neighbors</p></td>
    </tr>
    <tr>
      <th>mindist, maxdist</th>
      <td><p>distance range for 1D intervals</p></td>
    </tr>
    <tr>
      <th>mindist1, maxdist1, mindist2, maxdist2</th>
      <td><p>distance range for 2D intervals</p></td>
    </tr>
    <tr>
      <th>na.if.notfound</th>
      <td><p>if 'TRUE' return 'NA' interval if no matching neighbors were found, otherwise omit the interval in the answer</p></td>
    </tr>
    <tr>
      <th>intervals.set.out</th>
      <td><p>intervals set name where the function result is optionally outputed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function finds for each interval in 'intervals1' the closest 'maxneighbors' intervals from 'intervals2'.</p>
<p>For 1D intervals the distance must fall in the range of ['mindist', 'maxdist']. If 'intervals2' contains a 'strand' column the distance can be positive or negative depending on the 'strand' value and the position of interval2 relatively to interval1. If 'strand' column is missing the distance is always positive.</p>
<p>For 2D intervals two distances are calculated and returned for each axis. The distances must fall in the range of ['mindist1', 'maxdist1'] for axis 1 and ['mindist2', 'maxdist2'] for axis 2. For selecting the closest 'maxneighbors' intervals Manhattan distance is used (i.e. dist1+dist2).</p>
<p>If 'intervals.set.out' is not 'NULL' the result is saved as an intervals set. Use this parameter if the result size exceeds the limits of the physical memory.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If 'intervals.set.out' is 'NULL' a data frame containing the pairs of intervals from 'intervals1', intervals from 'intervals2'  and an additional column named 'dist' ('dist1'  and 'dist2' for 2D intervals) representing the distance between the corresponding intervals. If 'na.if.notfound' is 'TRUE', the data frame contains all the intervals from 'intervals1' including those for which no matching neighbor was found. For the latter intervals an 'NA' neighboring interval is stated. If 'na.if.notfound' is 'FALSE', the data frame contains only intervals from 'intervals1' for which matching neighbor(s) was found.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gintervals.html'>gintervals</a></code>,</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='fu'>gdb.init_examples</span>()
<span class='no'>intervs1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='giterator.intervals.html'>giterator.intervals</a></span>(<span class='st'>"dense_track"</span>,
                                <span class='fu'><a href='gintervals.html'>gintervals</a></span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>4000</span>),
                                <span class='kw'>iterator</span> <span class='kw'>=</span> <span class='fl'>233</span>)
<span class='no'>intervs2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='giterator.intervals.html'>giterator.intervals</a></span>(<span class='st'>"sparse_track"</span>,
                                <span class='fu'><a href='gintervals.html'>gintervals</a></span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>2000</span>))
<span class='fu'>gintervals.neighbors</span>(<span class='no'>intervs1</span>, <span class='no'>intervs2</span>, <span class='fl'>10</span>, <span class='kw'>mindist</span> <span class='kw'>=</span> -<span class='fl'>300</span>,
                     <span class='kw'>maxdist</span> <span class='kw'>=</span> <span class='fl'>500</span>)
<span class='no'>intervs2</span>$<span class='no'>strand</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>1</span>, -<span class='fl'>1</span>, <span class='fl'>1</span>)
<span class='fu'>gintervals.neighbors</span>(<span class='no'>intervs1</span>, <span class='no'>intervs2</span>, <span class='fl'>10</span>, <span class='kw'>mindist</span> <span class='kw'>=</span> -<span class='fl'>300</span>,
                     <span class='kw'>maxdist</span> <span class='kw'>=</span> <span class='fl'>500</span>)</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Misha Hoichman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


