<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Converts intervals to canonic form — gintervals.canonic • misha</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Converts intervals to canonic form — gintervals.canonic"><meta property="og:description" content="Converts intervals to canonic form."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">misha</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">4.2.13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Genomes.html">Genomes</a>
    </li>
    <li>
      <a href="../articles/Manual.html">Manual</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tanaylab/misha/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Converts intervals to canonic form</h1>
    <small class="dont-index">Source: <a href="https://github.com/tanaylab/misha/blob/master/R/intervals.R" class="external-link"><code>R/intervals.R</code></a></small>
    <div class="hidden name"><code>gintervals.canonic.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Converts intervals to canonic form.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gintervals.canonic</span><span class="op">(</span>intervals <span class="op">=</span> <span class="cn">NULL</span>, unify_touching_intervals <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-intervals">intervals<a class="anchor" aria-label="anchor" href="#arg-intervals"></a></dt>
<dd><p>intervals to be converted</p></dd>


<dt id="arg-unify-touching-intervals">unify_touching_intervals<a class="anchor" aria-label="anchor" href="#arg-unify-touching-intervals"></a></dt>
<dd><p>if 'TRUE', touching one-dimensional
intervals are unified</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame representing the canonic intervals and an attribute
'mapping' that maps the original intervals to the resulted ones.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function converts 'intervals' into a "canonic" form: properly sorted
with no overlaps. The result can be used later in the functions that require
the intervals to be in canonic form. Use 'unify_touching_intervals' to
control whether the intervals that touch each other (i.e. the end coordinate
of one equals to the start coordinate of the other) are unified.
'unify_touching_intervals' is ignored if two-dimensional intervals are used.</p>
<p>Since 'gintervals.canonic' unifies overlapping or touching intervals, the
number of the returned intervals might be less than the number of the
original intervals. To allow the user to find the origin of the new interval
'mapping' attribute is attached to the result. It maps between the original
intervals and the resulted intervals. Use 'attr(retv_of_gintervals.canonic,
"mapping")' to retrieve the map.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gintervals.html">gintervals</a></code>, <code><a href="gintervals.2d.html">gintervals.2d</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="gdb.init.html">gdb.init_examples</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Create intervals manually by using 'data.frame'.</span></span></span>
<span class="r-in"><span><span class="co">## Note that we add an additional column 'data'.</span></span></span>
<span class="r-in"><span><span class="co">## Return value:</span></span></span>
<span class="r-in"><span><span class="co">##   chrom start   end data</span></span></span>
<span class="r-in"><span><span class="co">## 1  chr1 11000 12000   10</span></span></span>
<span class="r-in"><span><span class="co">## 2  chr1   100   200   20</span></span></span>
<span class="r-in"><span><span class="co">## 3  chr1 10000 13000   30</span></span></span>
<span class="r-in"><span><span class="co">## 4  chr1 10500 10600   40</span></span></span>
<span class="r-in"><span><span class="va">intervs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    chrom <span class="op">=</span> <span class="st">"chr1"</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11000</span>, <span class="fl">100</span>, <span class="fl">10000</span>, <span class="fl">10500</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12000</span>, <span class="fl">200</span>, <span class="fl">13000</span>, <span class="fl">10600</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Convert the intervals into the canonic form.</span></span></span>
<span class="r-in"><span><span class="co">## The function discards any columns besides chrom, start and end.</span></span></span>
<span class="r-in"><span><span class="co">## Return value:</span></span></span>
<span class="r-in"><span><span class="co">##  chrom start   end</span></span></span>
<span class="r-in"><span><span class="co">## 1  chr1   100   200</span></span></span>
<span class="r-in"><span><span class="co">## 2  chr1 10000 13000</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">gintervals.canonic</span><span class="op">(</span><span class="va">intervs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## By inspecting mapping attribute we can see how the new</span></span></span>
<span class="r-in"><span><span class="co">## intervals were created: "2 1 2 2" means that the first</span></span></span>
<span class="r-in"><span><span class="co">## interval in the result was created from the second interval in</span></span></span>
<span class="r-in"><span><span class="co">## the original set (we look for the indices in mapping where "1"</span></span></span>
<span class="r-in"><span><span class="co">## appears). Likewise the second interval in the result was</span></span></span>
<span class="r-in"><span><span class="co">## created from 3 intervals in the original set. Their indices are</span></span></span>
<span class="r-in"><span><span class="co">## 1, 3 and 4 (once again we look for the indices in mapping where</span></span></span>
<span class="r-in"><span><span class="co">## "2" appears).</span></span></span>
<span class="r-in"><span><span class="co">## Return value:</span></span></span>
<span class="r-in"><span><span class="co">## 2 1 2 2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"mapping"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2 1 2 2</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Finally (and that is the most useful part of 'mapping'</span></span></span>
<span class="r-in"><span><span class="co">## attribute): we add a new column 'data' to our result which is</span></span></span>
<span class="r-in"><span><span class="co">## the mean value of the original data column. The trick is done</span></span></span>
<span class="r-in"><span><span class="co">## using 'tapply' on par with 'mapping' attribute. For example,</span></span></span>
<span class="r-in"><span><span class="co">## 20.00000 equals is a result of 'mean(intervs[2,]$data' while</span></span></span>
<span class="r-in"><span><span class="co">## 26.66667 is a result of 'mean(intervs[c(1,3,4),]$data)'.</span></span></span>
<span class="r-in"><span><span class="co">## 'res' after the following call:</span></span></span>
<span class="r-in"><span><span class="co">##  chrom start   end     data</span></span></span>
<span class="r-in"><span><span class="co">## 1  chr1   100   200 20.00000</span></span></span>
<span class="r-in"><span><span class="co">## 2  chr1 10000 13000 26.66667</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html" class="external-link">tapply</a></span><span class="op">(</span><span class="va">intervs</span><span class="op">$</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"mapping"</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Misha Hoichman, Aviezer Lifshitz, Eitan Yaffe, Amos Tanay.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

