<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Returns values from a lookup table based on track expression — glookup • misha</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">misha</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/manual.Rnw">
    <span class="fa fa-stethoscope"></span>
     
    User Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bitbucket.org/aviezerl/misha-package">
    <span class="fa fa-bitbucket-square"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Returns values from a lookup table based on track expression</h1>
    </div>

    
    <p>Evaluates track expression and translates the values into bin indices that are used in turn to retrieve and return values from a lookup table.</p>
    

    <pre class="usage">glookup(lookup_table, [expr, breaks]+, intervals,
        include.lowest = FALSE, force.binning = TRUE,
        iterator = NULL, band = NULL, intervals.set.out = NULL)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lookup_table</th>
      <td><p>a multi-dimensional array containing the values that are returned by the function</p></td>
    </tr>
    <tr>
      <th>expr</th>
      <td><p>track expression</p></td>
    </tr>
    <tr>
      <th>breaks</th>
      <td><p>breaks that determine the bin</p></td>
    </tr>
    <tr>
      <th>intervals</th>
      <td><p>genomic scope for which the function is applied</p></td>
    </tr>
    <tr>
      <th>include.lowest</th>
      <td><p>if 'TRUE', the lowest value of the range determined by breaks is included</p></td>
    </tr>
    <tr>
      <th>force.binning</th>
      <td><p>if 'TRUE', the values smaller than the minimal break will be translated to index 1, and the values that exceed the maximal break will be translated to index N-1 where N is the number of breaks. If 'FALSE' the out-of-range values will produce NaN values.</p></td>
    </tr>
    <tr>
      <th>iterator</th>
      <td><p>track expression iterator. If 'NULL' iterator is determined implicitly based on track expressions.</p></td>
    </tr>
    <tr>
      <th>band</th>
      <td><p>track expression band. If 'NULL' no band is used.</p></td>
    </tr>
    <tr>
      <th>intervals.set.out</th>
      <td><p>intervals set name where the function result is optionally outputed</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function evaluates the track expression for all iterator intervals and translates this value into an index based on the breaks. This index is then used to address the lookup table and return the according value. More than one 'expr'-'breaks' pair can be used. In that case 'lookup_table' is addressed in a multidimensional manner, i.e. 'lookup_table[i1, i2, ...]'.</p>
<p>The range of bins is determined by 'breaks' argument. For example: 'breaks = c(x1, x2, x3, x4)' represents three different intervals (bins): (x1, x2], (x2, x3], (x3, x4].</p>
<p>If 'include.lowest' is 'TRUE' then the lowest value is included in the first interval, i.e. in [x1, x2].</p>
<p>'force.binning' parameter controls what should be done when the value of 'expr' exceeds the range determined by 'breaks'. If 'force.binning' is 'TRUE' then values smaller than the minimal break will be translated to index 1, and the values exceeding the maximal break will be translated to index 'M-1' where 'M' is the number of breaks. If 'force.binning' is 'FALSE' the out-of-range values will produce 'NaN' values.</p>
<p>Regardless of 'force.binning' value if the value of 'expr' is 'NaN' then result is 'NaN' too.</p>
<p>The order inside the result might not be the same as the order of intervals. Use 'intervalID' column to refer to the index of the original interval from the supplied 'intervals'.</p>
<p>If 'intervals.set.out' is not 'NULL' the result (without 'columnID' column) is saved as an intervals set. Use this parameter if the result size exceeds the limits of the physical memory.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If 'intervals.set.out' is 'NULL' a set of intervals with additional 'value' and 'columnID' columns.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='gtrack.lookup.html'>gtrack.lookup</a></code>, <code><a href='gextract.html'>gextract</a></code>, <code><a href='gpartition.html'>gpartition</a></code>, <code><a href='gdist.html'>gdist</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>gdb.init_examples</span>()

<span class='co'>## one-dimensional lookup table</span>
<span class='no'>breaks1</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>6</span>)
<span class='fu'>glookup</span>(<span class='fl'>1</span>:<span class='fl'>5</span>, <span class='st'>"dense_track"</span>, <span class='no'>breaks1</span>, <span class='fu'><a href='gintervals.html'>gintervals</a></span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>200</span>))</div><div class='output co'>#&gt;   chrom start end value intervalID
#&gt; 1  chr1     0  50     4          1
#&gt; 2  chr1    50 100     3          1
#&gt; 3  chr1   100 150     5          1
#&gt; 4  chr1   150 200     3          1</div><div class='input'>
<span class='co'>## two-dimensional lookup table</span>
<span class='no'>t</span> <span class='kw'>&lt;-</span> <span class='fu'>array</span>(<span class='fl'>1</span>:<span class='fl'>15</span>, <span class='kw'>dim</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>5</span>, <span class='fl'>3</span>))
<span class='no'>breaks2</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>0.31</span>, <span class='fl'>0.37</span>, <span class='kw'>length.out</span> <span class='kw'>=</span> <span class='fl'>4</span>)
<span class='fu'>glookup</span>(<span class='no'>t</span>, <span class='st'>"dense_track"</span>, <span class='no'>breaks1</span>, <span class='st'>"2 * dense_track"</span>, <span class='no'>breaks2</span>,
        <span class='fu'><a href='gintervals.html'>gintervals</a></span>(<span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>200</span>))</div><div class='output co'>#&gt;   chrom start end value intervalID
#&gt; 1  chr1     0  50    14          1
#&gt; 2  chr1    50 100     3          1
#&gt; 3  chr1   100 150    15          1
#&gt; 4  chr1   150 200     3          1</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Misha Hoichman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
