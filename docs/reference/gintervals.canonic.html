<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Converts intervals to canonic form — gintervals.canonic • misha</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">misha</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/manual.Rnw">
    <span class="fa fa-stethoscope"></span>
     
    User Manual
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-th-list"></span>
     
    Reference
  </a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://bitbucket.org/aviezerl/misha-package">
    <span class="fa fa-bitbucket-square"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Converts intervals to canonic form</h1>
    </div>

    
    <p>Converts intervals to canonic form.</p>
    

    <pre class="usage"><span class='fu'>gintervals.canonic</span>(<span class='no'>intervals</span>, <span class='kw'>unify_touching_intervals</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>intervals</th>
      <td><p>intervals to be converted</p></td>
    </tr>
    <tr>
      <th>unify_touching_intervals</th>
      <td><p>if 'TRUE', touching one-dimensional intervals are unified</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function converts 'intervals' into a "canonic" form: properly sorted with no overlaps. The result can be used later in the functions that require the intervals to be in canonic form. Use 'unify_touching_intervals' to control whether the intervals that touch each other (i.e. the end coordinate of one equals to the start coordinate of the other) are unified. 'unify_touching_intervals' is ignored if two-dimensional intervals are used.</p>
<p>Since 'gintervals.canonic' unifies overlapping or touching intervals, the number of the returned intervals might be less than the number of the original intervals. To allow the user to find the origin of the new interval 'mapping' attribute is attached to the result. It maps between the original intervals and the resulted intervals. Use 'attr(retv_of_gintervals.canonic, "mapping")' to retrieve the map.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data frame representing the canonic intervals and an attribute 'mapping' that maps the original intervals to the resulted ones.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='gintervals.html'>gintervals</a></code>, <code><a href='gintervals.2d.html'>gintervals.2d</a></code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>gdb.init_examples</span>()

<span class='co'>## Create intervals manually by using 'data.frame'.</span>
<span class='co'>## Note that we add an additional column 'data'.</span>
<span class='co'>## Return value:</span>
<span class='co'>##   chrom start   end data</span>
<span class='co'>## 1  chr1 11000 12000   10</span>
<span class='co'>## 2  chr1   100   200   20</span>
<span class='co'>## 3  chr1 10000 13000   30</span>
<span class='co'>## 4  chr1 10500 10600   40</span>
<span class='no'>intervs</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>chrom</span> <span class='kw'>=</span> <span class='st'>"chr1"</span>,
                      <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>11000</span>, <span class='fl'>100</span>, <span class='fl'>10000</span>, <span class='fl'>10500</span>),
                      <span class='kw'>end</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>12000</span>, <span class='fl'>200</span>, <span class='fl'>13000</span>, <span class='fl'>10600</span>),
                      <span class='kw'>data</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>10</span>, <span class='fl'>20</span>, <span class='fl'>30</span>, <span class='fl'>40</span>))

<span class='co'>## Convert the intervals into the canonic form.</span>
<span class='co'>## The function discards any columns besides chrom, start and end.</span>
<span class='co'>## Return value:</span>
<span class='co'>##  chrom start   end</span>
<span class='co'>## 1  chr1   100   200</span>
<span class='co'>## 2  chr1 10000 13000</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>gintervals.canonic</span>(<span class='no'>intervs</span>)

<span class='co'>## By inspecting mapping attribute we can see how the new</span>
<span class='co'>## intervals were created: "2 1 2 2" means that the first</span>
<span class='co'>## interval in the result was created from the second interval in</span>
<span class='co'>## the original set (we look for the indices in mapping where "1"</span>
<span class='co'>## appears). Likewise the second interval in the result was</span>
<span class='co'>## created from 3 intervals in the original set. Their indices are</span>
<span class='co'>## 1, 3 and 4 (once again we look for the indices in mapping where</span>
<span class='co'>## "2" appears).</span>
<span class='co'>## Return value:</span>
<span class='co'>## 2 1 2 2</span>
<span class='fu'>attr</span>(<span class='no'>res</span>, <span class='st'>"mapping"</span>)</div><div class='output co'>#&gt; [1] 2 1 2 2</div><div class='input'>
<span class='co'>## Finally (and that is the most useful part of 'mapping'</span>
<span class='co'>## attribute): we add a new column 'data' to our result which is</span>
<span class='co'>## the mean value of the original data column. The trick is done</span>
<span class='co'>## using 'tapply' on par with 'mapping' attribute. For example,</span>
<span class='co'>## 20.00000 equals is a result of 'mean(intervs[2,]$data' while</span>
<span class='co'>## 26.66667 is a result of 'mean(intervs[c(1,3,4),]$data)'.</span>
<span class='co'>## 'res' after the following call:</span>
<span class='co'>##  chrom start   end     data</span>
<span class='co'>## 1  chr1   100   200 20.00000</span>
<span class='co'>## 2  chr1 10000 13000 26.66667</span>
<span class='no'>res</span>$<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>tapply</span>(<span class='no'>intervs</span>$<span class='no'>data</span>, <span class='fu'>attr</span>(<span class='no'>res</span>, <span class='st'>"mapping"</span>), <span class='no'>mean</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Misha Hoichman.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
